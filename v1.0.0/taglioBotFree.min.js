"use strict";function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_unsupportedIterableToArray(n)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(n,t){if(n){if("string"==typeof n)return _arrayLikeToArray(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(e="Object"===e&&n.constructor?n.constructor.name:e)||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(n,t):void 0}}function _iterableToArray(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}function _arrayWithoutHoles(n){if(Array.isArray(n))return _arrayLikeToArray(n)}function _arrayLikeToArray(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,o=new Array(t);e<t;e++)o[e]=n[e];return o}function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(n){return typeof n}:function _typeof(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}window.appBuilder=function(n){var r=this;if(r.staticMethods=null,r.instanceManager=null,r.root=null,r.innerAppId=null,r.useShadowRoot=null,r.app=null,"string"!=typeof n||""===n)throw"appName must be a non empty string";var i=n,n=function initialize(){r.app=window[i]=new function(){this.libs={},r.instanceManager=new o,this.instanceManager=r.instanceManager,r.staticMethods=new a,this.staticMethods=r.staticMethods,this.addStyle=r.addStyle,this.addToLibs=function(n){e(i,this.libs,n)},this.addToLibs(t)}};r.start=function(n){var t=n.elementIdToAppendFrom;if("string"!=typeof t||""===t)throw"elementIdToAppendFrom must be a non empty string";var e=document.getElementById(t);if(null===e)throw'elementIdToAppendFrom "'.concat(t,'" does not exist wihin dom');var o=n.useShadowRoot;if("boolean"!=typeof(o=void 0===o?!1:o))throw"useShadowRoot must be a boolean";r.useShadowRoot=o;var a="".concat(t,"_inner"),n=document.createElement("div");if(n.id=a,n.classList.add(i),null!==document.getElementById(a))throw'Id "'.concat(a,'" already exist. Please select another one for this');r.innerAppId=a,!0===o?(r.root=e.attachShadow({mode:"open"}),r.root.append(n)):(r.root=document,r.root.getElementById(t).append(n)),window[i].root=r.root,window[i].useShadowRoot=r.useShadowRoot,window[i].innerAppId=r.innerAppId};var t=function instance(n,t){var e=this,o=r.instanceManager,a=r.staticMethods;if("object"!==_typeof(n))throw"You must provide an object as prototype";if("string"!=typeof t||""===t)throw"You have to provide an id for the instance";if(o.exist(t))throw"Already exist an istance with id ->"+t;function J(){i=t,o.add(i,n),n.instance=e}var i=null;e.getId=function(){return i},e.destroy=function(){var n=e.findRoot();null!==n&&n.parentNode.removeChild(n),o.remove(i)},e.querySelector=function(n){return e.findRoot().querySelector(n)},e.querySelectorAll=function(n){return e.findRoot().querySelectorAll(n)},e.addStyle=function(n){r.addStyle(n)},e.findRoot=function(){return r.root.getElementById(i)},e.find=function(n){if("string"!=typeof n||""===n)throw"elementName must be a non empty string";return r.root.getElementById(i).querySelector('[data-el="'.concat(n,'"]'))},e.findAll=function(n){if("string"!=typeof n||""===n)throw"elementName must be a non empty string";return r.root.getElementById(i).querySelectorAll('[data-el="'.concat(n,'"]'))},e.createComponentDom=function(n,t,e){e=a.createDomNode(t,e);e.id=i,a.appendDomNode(n,e)},e.createComponentNode=function(n,t){t=a.createDomNode(n,t);return t.id=i,t},e.appendComponentNode=function(n,t){t.id=i,a.appendDomNode(n,t)},J()},e=function addToLibs(n,t,e){if("function"!=typeof e)throw"lib must be a function";var o,a=e.name;if(void 0===a)throw"lib name cannot be undefined";for(o in t)if(o===a)throw"there is a lib with the same name as ->"+a;t[a]=e};r.addStyle=function(n){if("string"!=typeof n||""===n)throw"styleContent must be a non empty string";var t=function getOrCreateDivStyleWrapper(){var n=document.createElement("div"),t="".concat(r.innerAppId,"_style"),e=r.root.getElementById(t);return null!==e?e:((!0===r.useShadowRoot?r.root:r.root.getElementById(r.innerAppId)).append(n),n.id=t,n)}(),e=document.createElement("div");e.innerHTML=n;e=e.firstElementChild;if(null!==document.getElementById(e.id))throw'Already exist a style node with id "'.concat(e.id,'"');t.append(e)};var o=function instanceManager(){function ra(n,t){if("string"!=typeof n||"id"===n)throw"invalid id. It must be a non empty string";if(this.id=n,"object"!==_typeof(t))throw"invalid instance. It must be an object";this.instance=t}var n=this,o=[];n.add=function(n,t){if(!n)throw"id must be provided";if(!t)throw"instance must be provided";var e=new ra(n,t);if(o.some(function(n){return n.id===e.id}))throw"instance already exists with name -> "+n;o.push(e)},n.get=function(t){if(!t)throw"id must be provided";var n=o.find(function(n){return n.id===t});if(void 0===n)throw"instance with id '".concat(t,"' does not exist");if(void 0===n.instance)throw"instance with id '".concat(t,"' does not exist");return n.instance},n.getOrNull=function(t){if(!t)throw"id must be provided";var n=o.find(function(n){return n.id===t});return void 0===n||void 0===n.instance?null:n.instance},n.exist=function(t){if(!t)throw"id must be provided";return o.some(function(n){return n.id===t})},n.remove=function(t){if(!t)throw"id must be provided";var n=o.findIndex(function(n){return n.id===t});-1!==n?o.splice(n,1):console.warn("No instance was removed with this id => "+t)},n.startsWith=function(t){if(!t)throw"selector must be provided";return o.filter(function(n){return!0===n.id.startsWith(t)}).map(function(n){return n.instance})},n.getAll=function(){return o}},a=function staticMethods(){var o=this;o.listenTo_clickAnywhereOutOfElement=function(t,e){r.root.addEventListener("click",function handler(n){!0!=(null!==n.target.closest("#".concat(t)))&&(null!==r.root.getElementById(t)?e():r.root.removeEventListener("click",handler,!0))},!0)},o.createDom=function(n,t,e){e=o.createDomNode(t,e);o.appendDomNode(n,e)},o.createDomNode=function(n,t){n=o.replaceStringWith(n,t=void 0===t?[]:t),t=document.createElement("DIV");return t.innerHTML=n,t.firstElementChild},o.appendDomNode=function(n,t){r.root.getElementById(n).append(t)},o.mustAddClass=function(n,t,e){if(!n instanceof HTMLElement)throw"elment must be an html element";if("string"!=typeof t||""===t)throw"classNameToAdd must be a non empty string";if("boolean"!=typeof e)throw"mustAdd must be a non empty string";n=n.classList;!0===e?n.contains(t)||n.add(t):n.remove(t)},o.toggleClass=function(n,t){if(!n instanceof HTMLElement)throw"elment must be an html element";if("string"!=typeof t||""===t)throw"classNameToToggle must be a non empty string";n=n.classList;n.contains(t)?n.remove(t):n.add(t)},o.replaceStringWith=function(n,o){if(!Array.isArray(o))throw"objectWithKeyValues must be an array";if(void 0===n)throw"StringText to replaced is undefined. Fix it";var a=[],i=n;return o.forEach(function(e){function wb(t){if(a.some(function(n){return n===t}))throw console.log(o),"key '".concat(t,"' already exist. See data above");if(null===e[t])throw"value with key ".concat(t," is null");var n=new RegExp("{".concat(t,"}"),"g");i=i.replace(n,e[t]),a.push(t)}for(var n in e)wb(n)}),i};var e=1,a=0;o.newUniqueId=function(){var n=(new Date).getTime();n===a?e++:e=1;var t="".concat(n,"-").concat(e);return a=n,t},o.groupBy=function(n,e){if(!Array.isArray(n))throw"must pass an array";if(void 0===n[0][e])throw"collection must have this property to group by => "+e;return n.reduce(function(n,t){return(n[t[e]]=n[t[e]]||[]).push(t),n},{})},o.makeHttpRequest=function(n,a){var t=n.url,e=n.headers,o=n.verb,i=n.body;if("string"!=typeof t||""===t)throw"url must be a non empty string";if("object"!==_typeof(e=void 0===e?{}:e)||null===e)throw"headers must be a non null object";n=["GET","POST"];if(!n.some(function(n){return n===o}))throw"verb '".concat(o,"' is not a valid one. It must be either of these: ").concat(n.join(", "));if("string"!=typeof(i=void 0===i?"":i))throw"body must be an string";var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===this.readyState){var n=r.status,t=r.responseText,e=r.getAllResponseHeaders(),o=null;try{o=JSON.parse(t)}catch(n){console.warn("Fail to parse the response of the expressions")}a({status:n,responseAsText:t,responseHeaders:e,responseAsObject:o})}},r.open(o,t,!0),Object.keys(e).forEach(function(n){var t=e[n];r.setRequestHeader(n,t)}),""===i?r.send():r.send(i)}};n()},function(){var e=new window.appBuilder("taglio_chat_app"),n=e.app,o=!1,a="taglio_chat_app_holder";n.start=function(n){if(!o){o=!0,i(),e.start({elementIdToAppendFrom:a,useShadowRoot:!0});var t=window.taglio_chat_app.libs;if(window.taglio_chat_app.addStyle(t.app_style()),null===document.getElementById(a))throw"appElement cannot be null at this point";new t.conversationQueue,new t.conversationManager,new t.messagesCommon,void 0!==t.freeManager&&new t.freeManager,r(n);n={idElementToAppendFrom:window.taglio_chat_app.innerAppId,id:"chatLayout",appOptions:n};new t.chatLayout(n)}},n.getVariables=function(){return window.taglio_chat_app.instanceManager.get("conversationQueue").getAllVariables()};var i=function createDivHolderAndAppend(){var n=document.createElement("DIV");n.id=a,document.body.append(n)},r=function throwIfFreeAndAccessToProperty(n){var t=window.taglio_chat_app.instanceManager.getOrNull("freeManager");if(null!==t){var e=t.allowedOptions,t=Object.keys(n).every(function(t){return e.some(function(n){return n===t})}),n=e.join(", ");if(!t)throw'you can only use these options: "'.concat(n,'" in the free edition when starting the chat. Upgrade to premium')}};window.taglio_chat_app.version="1.0.0",console.log(window.taglio_chat_app.version)}(),window.taglio_chat_app.addToLibs(function app_style(){return'\n<style id="app_style">\n    \n\n.taglioChapApp_chatLayout_wrapper {\n    /* Width of chat */\n    --chat-width: 352px;\n\n    /* Position */\n    --chat_bottom: 15px;\n    --chat_top: auto;\n    --chat_left: 15px;\n    --chat_right: auto;\n\n    /* Primary color */\n    --primary_color: rgb(31, 115, 183);\n    --agent_chat_color:  rgb(233, 235, 237);\n    --default_text_color: #2f3941;\n    --white_color: rgb(255, 255, 255);\n    --gray_color: rgb(104, 115, 125);\n    --soft_gray_color: rgb(216, 220, 222);\n    --box_gray_color: rgba(104, 115, 125, 0.35) 0px 0px 0px 3px;\n}\n  \n.taglioChapApp_chatLayout_wrapper .chat_item{\n    white-space: pre-wrap;\n    border-radius: 16px;\n    line-height: 16px;\n    padding: 8px 12px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n}\n\n/* Animation for chat appearing */\n.taglioChapApp_chatLayout_wrapper .js__prepareChatAppearingAnimation{\n    transition: transform 0.25s linear;\n    transition: opacity 0.25s linear;\n    transform: scale(0.5);\n    opacity: 0.2;\n}\n\n.taglioChapApp_chatLayout_wrapper .js__animateChatAppearingAnimation{\n    transform: scale(1);\n    opacity: 1;\n}\n\n.taglioChapApp_chatLayout_wrapper var{\n    font-style: normal;\n}\n\n.taglioChapApp_chatLayout_wrapper a{\n    font-style: normal;\n    color: yellow;\n}\n\n.taglioChapApp_chatLayout_wrapper div.icon svg{\n    width: 1em;\n}\n\n.taglioChapApp_chatLayout_wrapper div.icon{\n    display: inline-flex;\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function chatLayout_style(){return'\n<style id="chatLayout_style">\n\nbody{\n    margin: 0;\n}\n\n.taglioChapApp_chatLayout_wrapper{\n    position: fixed;\n    bottom: var(--chat_bottom);\n    left: var(--chat_left);\n    top: auto;\n    right: auto;\n}\n\n.taglioChapApp_chatLayout{\n    \n    min-width: 320px;\n    min-height: 450px;\n\n    width: var(--chat-width);\n    display: flex;\n    flex-direction: column;\n\n    box-sizing: border-box;\n    line-height: 20px;\n    color: var(--default_text_color);\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n    font-size: 14px;\n    border-radius: 8px;\n    box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px;\n    background-color:var(--white_color);\n    /* user-select: none; */\n}\n\n.taglioChapApp_chatLayout .header{\n    border-top-right-radius: 8px;\n    border-top-left-radius: 8px;\n\n    font-size: 15px;\n    background: var(--primary_color);\n    color: var(--white_color);\n    display: flex;\n}\n\n/* Header */\n.taglioChapApp_chatLayout .header_icon, \n.taglioChapApp_chatLayout .header_in_center{\n    /* Padding of whole header */\n    padding: 12px 0;\n}\n\n.taglioChapApp_chatLayout .header_in_common{\n    flex: 1;\n}\n\n.taglioChapApp_chatLayout .header_in_center{\n    font-weight: bold;\n    display: flex;\n    justify-content: center;\n}\n\n.taglioChapApp_chatLayout .header_in_right{\n    display: flex;\n    justify-content: flex-end;\n}\n\n/* Header: icons */\n.taglioChapApp_chatLayout .header_icon{\n    font-size: 13px;\n    padding-right: 9px;\n    padding-left: 9px;\n    cursor: pointer;\n}\n\n.taglioChapApp_chatLayout .header_icon:hover,\n.taglioChapApp_chatLayout .header_icon:focus{\n    opacity: 0.7;\n    transform: scale(1.1);\n}\n\n.taglioChapApp_chatLayout .header_icon_spacer{\n    margin-right: 13px;\n    padding: 0;\n}\n\n/* Inner header */\n.taglioChapApp_chatLayout .inner_header{\n    padding: 12px 16px;\n    display: flex;\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 6px 12px 0px;\n}\n\n.taglioChapApp_chatLayout .inner_header_icon_wrapper_2{\n    font-size: 30px;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .inner_header_right{\n    margin-left: 10px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n}\n\n.taglioChapApp_chatLayout .inner_header_text{\n    line-height: 16px;\n    margin: 0;\n}\n\n.taglioChapApp_chatLayout .inner_header_text:first-child{\n    font-weight: bold;\n}\n\n/* Content */\n.taglioChapApp_chatLayout .content{\n    overflow: auto;\n    height: 280px;\n    display: flex;\n    flex-direction: column;\n    padding: 15px 20px;\n}\n\n.taglioChapApp_chatLayout .chat_notification{\n    align-self: center;\n    white-space: pre-wrap;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    padding: 12px 0;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .chat_visitor_alias{\n    align-self: flex-start;\n    white-space: pre-wrap;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-left: 7px;\n    margin-bottom: 8px;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .chat_separator{\n    padding-top: 7px;\n    margin: 0;\n}\n/* Input */\n.taglioChapApp_chatLayout .input{\n    display: flex;\n    flex-direction: column;\n    padding: 15px 20px 10px 20px;\n}\n\n.taglioChapApp_chatLayout .input_textarea{\n    appearance: none;\n    border: 1px solid;\n    border-color: var(--soft_gray_color);\n    border-radius: 4px;\n    width: 100%;\n    box-sizing: border-box;\n    vertical-align: middle;\n    padding: 10px 12px;\n    line-height: 1.28571;\n    background-color: var(--white_color);\n    color: var(--default_text_color);\n    resize: none;\n    overflow: auto;\n    cursor: auto;\n    height: 75px;\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n}\n\n.taglioChapApp_chatLayout .input_textarea::placeholder {\n    opacity: 0.6;\n}\n\n.taglioChapApp_chatLayout .input_textarea:focus{\n    border-color: var(--gray_color);\n    box-shadow: var(--box_gray_color);\n    outline: none;\n}\n.taglioChapApp_chatLayout .input_textarea:hover{\n    border-color: var(--default_text_color);\n}\n\n/* Input : footer icons */\n.taglioChapApp_chatLayout .icon_group{\n    margin-top: 13px;\n    display: flex;\n    justify-content: space-between;\n    line-height: 1;\n    align-items: center;\n}\n\n.taglioChapApp_chatLayout .footer_icon{\n    cursor: pointer;\n    vertical-align: middle;\n    position: relative;\n}\n\n.taglioChapApp_chatLayout .iconWrapper{\n    position: relative;\n    padding: 5px;\n    display: flex;\n}\n\n.taglioChapApp_chatLayout .footer_icon:hover,\n.taglioChapApp_chatLayout .footer_icon:focus{\n    opacity: 0.7;\n    transform: scale(1.1);\n}\n\n  /* Separation between chats */\n  .taglioChapApp_chatLayout .agent + .visitor{\n      margin-top: 20px;\n  }\n  .taglioChapApp_chatLayout .visitor + .agent{\n      margin-top: 20px;\n  }\n\n  /* Button to hide */\n\n.taglioChapApp_chatLayout_wrapper .buttonHelpIcon{\n    font-size: 20px;\n}\n\n.taglioChapApp_chatLayout_wrapper .buttonHelpText{\n    margin: 0;\n    margin-left: 8px;\n}\n\n.taglioChapApp_chatLayout_wrapper .showButton{\n    display:flex;\n    padding: 13px 22px;\n    background-color:var(--primary_color);\n    font-size: 15px;\n    color: white;\n    border-radius: 25px;\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n    font-weight:bold;\n    cursor: pointer;\n}\n\n  /* Button to hide default: show is hidden by default */\n.taglioChapApp_chatLayout_wrapper .showButton{\n    display:none;\n}\n\n.taglioChapApp_chatLayout_wrapper .taglioChapApp_chatLayout{\n    display:flex;\n}\n\n/* Button to hide "show button": */\n.taglioChapApp_chatLayout_wrapper.js__showButton .showButton{\n    display:flex;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__showButton .taglioChapApp_chatLayout{\n    display:none;\n}\n\n/* Send button */\n.taglioChapApp_chatLayout .textAreaWrapper{\n    position: relative;\n}\n\n.taglioChapApp_chatLayout .sendIcon{\n    position: absolute;\n    top: 50%;\n    right: 0;\n    padding: 18px;\n    font-size: 18px;\n    transform: translateY(-50%);\n    cursor: pointer;\n    \n    border-radius: 50%;\n    margin-right:5px;\n}\n\n.taglioChapApp_chatLayout .sendIcon:hover{\n    background-color: var(--primary_color);\n    color: var(--white_color);\n}\n\n.taglioChapApp_chatLayout .input_textarea{\n    padding-right: 65px;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar-track{\n\t-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n\tbackground-color: #F5F5F5;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar{\n\twidth: 10px;\n\tbackground-color: #F5F5F5;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar-thumb{\n\tbackground-color: #000000;\n\tborder: 2px solid #555555;\n}\n\n/* Avatar */\n.taglioChapApp_chatLayout_wrapper.js__showAvatar .avatarDefault{\n    display: none;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__showAvatar .avatar{\n    display: flex;\n}\n\n.taglioChapApp_chatLayout_wrapper .avatar{\n    display:none;\n    width: 30px;\n    max-height: 30px;\n    align-self: center;\n}\n\n/* callout */\n.speech_alert{\n    width: 20px;\n    height: 20px;\n    border: 2px solid white;\n    border-radius: 12px;\n    font-size:12px;\n\n    background: #fff;\n    color: #000;\n    text-align: center;\n    background: red;\n    color: white;\n    top: -3px;\n    right: -8px;\n    position: absolute;\n}\n.box2-wrapper{\n    \n    position: relative;\n}\n.box2 {\nbottom:0;\nborder-radius:5px;\n    margin-bottom: 10px;\n    border: 2px solid var(--primary_color);\n    padding: 10px;\n    text-align: center;\n    color: var(--default_text_color);\n    font-family: arial;\n    position:absolute;\n    width:130px;\n    box-shadow: rgba(0, 0, 0, 0.4) 0px 0px 10px 0px;\n}\n\n.sb9:before {\n  content: "";\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid var(--primary_color);\n  border-bottom: 12px solid transparent;\n  right: 50%;\n  bottom: -23px;\n}\n\n.sb9:after {\n  content: "";\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid #fff;\n  border-bottom: 10px solid transparent;\n  right: 50%;\n  bottom: -18px;\n}\n\n\n/* Movil layout */\n@media only screen and (max-width: 800px) {\n    .taglio_chat_app{\n        position:fixed;\n        z-index: 999999999999;\n    }\n    .taglioChapApp_chatLayout{\n        width: 100%;\n        height: 100vh;\n        position: fixed;\n        left: 0;\n        top: 0;\n        border-radius: 0;\n    }\n    \n    .taglioChapApp_chatLayout_wrapper{\n        \n    }\n\n    .taglioChapApp_chatLayout .header {\n        border-top-right-radius: 0;\n        border-top-left-radius: 0;\n    }\n    .taglioChapApp_chatLayout .content{\n        height: 100%;\n    }\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function chatLayout_template(){return'\n    \n<div class="taglioChapApp_chatLayout_wrapper js__showButton js__showAvatar">\n\n  <div class="box2-wrapper" style="display:none">\n    <div class="box2 sb9">I\'m speech bubble, would you lie to know more?</div>\n  </div>\n\n  <div data-el="show_button" class="showButton">\n    <div class="speech_alert" style="display:none">1</div>\n    <div class="buttonHelpIcon icon">\n      <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="question-circle" class="svg-inline--fa fa-question-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm107.244-255.2c0 67.052-72.421 68.084-72.421 92.863V300c0 6.627-5.373 12-12 12h-45.647c-6.627 0-12-5.373-12-12v-8.659c0-35.745 27.1-50.034 47.579-61.516 17.561-9.845 28.324-16.541 28.324-29.579 0-17.246-21.999-28.693-39.784-28.693-23.189 0-33.894 10.977-48.942 29.969-4.057 5.12-11.46 6.071-16.666 2.124l-27.824-21.098c-5.107-3.872-6.251-11.066-2.644-16.363C184.846 131.491 214.94 112 261.794 112c49.071 0 101.45 38.304 101.45 88.8zM298 368c0 23.159-18.841 42-42 42s-42-18.841-42-42 18.841-42 42-42 42 18.841 42 42z"></path></svg>\n    </div>\n    <p class="buttonHelpText">{chatTitle}</p>\n     \n  </div>\n  \n  <div class="taglioChapApp_chatLayout">\n\n    <div class="header">\n      <div class="header_in_common header_in_left"></div>\n      <div class="header_in_common header_in_center">{chatTitle}</div>\n      <div class="header_in_common header_in_right">\n        <div class="icon header_icon" data-el="minimize">\n          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="window-minimize" class="svg-inline--fa fa-window-minimize fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 352H48c-26.5 0-48 21.5-48 48v32c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-32c0-26.5-21.5-48-48-48z"></path></svg>\n         </div>\n        <i class="header_icon header_icon_spacer"></i>\n      </div>\n    </div>\n\n    <div class="inner_header">\n      <div class="icon inner_header_icon_wrapper_2">\n        <img data-el="avatar" class="avatar" />\n        <svg class="avatarDefault" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-circle" class="svg-inline--fa fa-user-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"></path></svg>\n      </div>\n      <div class="inner_header_right">\n          <p class="inner_header_text">{name}</p>\n          <p class="inner_header_text">{email}</p>\n      </div>\n    </div>\n\n    <div class="content" data-el="chat_content">\n    </div>\n\n    <div class="input"> \n      <div class="textAreaWrapper">\n        <textarea data-el="input_textarea" class="input_textarea" placeholder="Escriba un mensaje aqui..."></textarea>\n        <div class="icon sendIcon">\n          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="paper-plane" class="svg-inline--fa fa-paper-plane fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"></path></svg>\n        </div>\n      </div>\n      \n      <div class="icon_group">\n        <div class="icon_group_left">\n          tagliobot\n        </div>\n        <div class="icon_group_right">\n          <div class="iconWrapper">\n            <div class="footer_icon icon" data-el="footer_options" id="footer_options_holder">\n              <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="ellipsis-h" class="svg-inline--fa fa-ellipsis-h fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"></path></svg>\n            </div>\n            <div id="footerMenuHolder"></div>\n          </div>          \n        </div>\n      </div>\n    </div>\n\n  </div>\n\n  <script type="text/template" data-el="chat_notification">\n    <p class="chat_notification">{message}</p>\n  <\/script>\n\n</div>\n\n    '}),window.taglio_chat_app.addToLibs(function chatLayout(n){var e=window.taglio_chat_app.libs,o=window.taglio_chat_app.instanceManager,a=window.taglio_chat_app.staticMethods,i=this,r=new e.instance(i,"chatLayout"),t=window.taglio_chat_app.root,s=n.idElementToAppendFrom;if("string"!=typeof s||""===s)throw"invalid idElementToAppendFrom. Must be a non empty string";var p=n.appOptions;if("object"!==_typeof(p))throw"must pass appOptions";var c=p.title;if("string"!=typeof(c=void 0===c?"Support":c)||""===c)throw"invalid _chatTitle. Must be a non empty string";var l=p.name;if("string"!=typeof(l=void 0===l?"Robot":l)||""===l)throw"invalid _name. Must be a non empty string";var d=p.email;if("string"!=typeof(d=void 0===d?"robot@mail.com":d)||""===d)throw"invalid _email. Must be a non empty string";var u=p.avatar;if(null!==(u=void 0===u?null:u)&&"string"!=typeof d||""===d)throw"invalid _email. Must be a non empty string";var h=n,g=null,n=function initialize(){r.addStyle(e.chatLayout_style());var n=e.chatLayout_template(),t={chatTitle:O(c),name:O(l),email:O(d)},t=r.createComponentNode(n,[t]);S(t),r.appendComponentNode(s,t),new e.footerMenu({idElementToAppendFrom:"footerMenuHolder"}),j(),B(),I(),E(),w(),b(),C(),T(),_(),i.mustDisableTextArea(!0),m()};function chatLayoutModel(n){if("string"!=typeof n)throw"textAreaValue must be an string";this.textAreaValue=n}i.addChatNotification=function(n){F(n)},i.getChatContentId=function(){return g},i.mustDisableTextArea=function(n){R(n)};var f=null;i.listenToInputMessage=function(n){f=n},i.removeListenerToInputMessage=function(){f=null},i.loadConversation=function(){B();var n=p.conversation;o.get("conversationManager").prepareConversationOrThrow(n);function vd(){o.get("chatLayout").addChatNotification("Session ended")}var t=o.get("conversationQueue");t.listenToOnQueueFinished(vd),t.start(n)};function _c(){r.find("input_textarea").onkeyup=null}var m=function addLayoutStyle(){var n="rgb(31, 115, 183)";void 0!==h.primaryColor&&(n="--primary_color: ".concat(h.primaryColor,";"));n='\n        <style id="settings">\n            .taglioChapApp_chatLayout_wrapper {\n                '.concat(n,"\n            }\n        </style>\n        ");r.addStyle(n)},_=function listenTo_onWindowsLoad(){document.addEventListener("DOMContentLoaded",v)},v=function onWindowsLoaded(){var n=null!==localStorage.getItem("taglioRestartConversation");localStorage.removeItem("taglioRestartConversation"),n&&A()},w=function listenTo_onNodeAppended(){var n=r.find("chat_content");new MutationObserver(function(n){n.forEach(function(n){r.querySelectorAll("img").forEach(function(n){return n.onload=function(){return y()}}),y()})}).observe(n,{attributes:!1,childList:!0,characterData:!1})},y=function onNodeAppended(){var n=r.find("chat_content");n.scrollTop=n.scrollHeight},b=function listenTo_clickOnShowButton(){r.find("show_button").onclick=x},x=function clickOnShowButton(){A()},A=function startConversationIfNotStarted(){N(!1),!1===o.get("conversationQueue").conversationWasStarted()&&i.loadConversation()},C=function listenTo_clickOnMinimize(){r.find("minimize").onclick=M},M=function clickOnMinimize(){N(!0)},T=function listenTo_clickOnFooterOptions(){r.find("footer_options").onclick=L},L=function clickOnFooterOptions(){o.get("footerMenu").show()},I=function listenTo_onReturnKeyUp(){r.find("input_textarea").onkeyup=function(n){"Enter"===n.code&&(n.preventDefault(),k())}},k=function onReturnKeyPressed(){var n=H();""!==n.textAreaValue.trim()&&D(n.textAreaValue)},E=function listenTo_onReturnKeyDown(){r.find("input_textarea").onkeydown=function(n){"Enter"===n.code&&n.preventDefault()}},S=function buildAvatar(n){null!==u&&(a.mustAddClass(n,"js__showAvatar",!0),n.querySelector('[data-el="avatar"]').setAttribute("src",O(u)))},O=function sanitizeHtml(n){var t=document.createElement("DIV");return t.innerHTML=n,t.innerText},N=function showButton(n){var t=r.findRoot();a.mustAddClass(t,"js__showButton",n)},j=function createChatContentId(){var n=r.find("chat_content"),t=r.getId();g="".concat(t,"-chatContent"),n.id=g},F=function addChatNotification(n){var t=r.find("chat_notification").innerHTML;a.createDom(g,t,[{message:n}])},D=function addVisitorMessage(n){var t={idElementToAppendFrom:i.getChatContentId(),text:n};new e.visitorMessage(t).runSync(),null!==f&&f(n),z(new chatLayoutModel(""))},B=function cleanChatContent(){t.getElementById(g).innerHTML=""},H=function getModel(){return new chatLayoutModel(r.find("input_textarea").value)},z=function setModel(n){r.find("input_textarea").value=n.textAreaValue},R=function mustDisableTextArea(n){(n?_c:I)()};n()}),window.taglio_chat_app.addToLibs(function footerMenu_style(){return'\n<style id="footerMenu_style">\n/* Footer menu */\n.taglioChapApp_footerMenu{\n    position:absolute;\n    background-color: var(--white_color);\n    border-radius:8px;\n    bottom: 100%;\n    width: auto;\n    height: auto;\n    box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem{\n    margin: 0;\n    padding: 12px 17px;\n    white-space:nowrap;\n    cursor: pointer;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover,\n.taglioChapApp_footerMenu .footerMenuItem:focus\n{\n    color: var(--white_color);\n    background-color: var(--primary_color);\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover:first-child,\n.taglioChapApp_footerMenu .footerMenuItem:focus:first-child\n{\n    border-top-right-radius:8px;\n    border-top-left-radius:8px;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover:last-child,\n.taglioChapApp_footerMenu .footerMenuItem:focus:last-child\n{\n    border-bottom-right-radius:8px;\n    border-bottom-left-radius:8px;\n}\n\n.taglioChapApp_footerMenu.js__hideFooterMenu{\n    display: none;\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function footerMenu_template(){return'\n  <div class="taglioChapApp_footerMenu js__hideFooterMenu">\n    <p data-el="option" data-method="restartConversation" class="footerMenuItem">Restart conversation</p>\n    <p data-el="option" data-method="endConversation" class="footerMenuItem">End conversation</p>\n  </div>\n    '}),window.taglio_chat_app.addToLibs(function footerMenu(n){var t=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=new t.instance(this,"footerMenu"),i=n.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";n=function initialize(){a.addStyle(t.footerMenu_style());var n=t.footerMenu_template();a.createComponentDom(i,n),p()};this.show=function(){u(!1),r()};var r=function listenTo_clickOnAnywhereOutOfFooterOptions(){o.listenTo_clickAnywhereOutOfElement(a.getId(),s)},s=function clickOnAnywhereOutOfFooterOptions(){u(!0)},p=function listenTo_clickOnOption(){a.findAll("option").forEach(function(n){n.onclick=function(n){n=n.target.getAttribute("data-method");if(void 0===n)throw"There is an option with no data-method attribute defined";c(n)}})},c=function clickOnOption(n){var t={restartConversation:l,endConversation:d}[n];if(void 0===t)throw'Method to run "'.concat(n,'" is not defined in the valid methods to run');t(),u(!0)},l=function restartConversation(){localStorage.setItem("taglioRestartConversation","1"),window.location.reload()},d=function endConversation(){console.log("endConversation"),e.get("conversationQueue").endConversationOnDemand()},u=function mustHideFooterMenu(n){var t=a.findRoot();o.mustAddClass(t,"js__hideFooterMenu",n)};n()}),window.taglio_chat_app.addToLibs(function conversationManager(){var t=this,n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,r=window.taglio_chat_app.staticMethods,s=(new n.instance(t,"conversationManager"),[]),p=0,c=0;function processConversationsModel(n,t){if("string"!=typeof n||""===n)throw"id must be a non empty string";if(this.conversationId=n,!Number.isInteger(t)||t<=0)throw"length must be an integer higher than zero";this.length=t}t.prepareConversationOrThrow=function(o,a){if(void 0===a&&(a=!1),!Array.isArray(o))throw"conversation must be an array";var i=r.newUniqueId();if(s.push(new processConversationsModel(i,o.length)),(p+=o.length)<c)throw'You overpass the number of "'.concat(p,'"');o.forEach(function(n,t){if(c++,null===n)return u(n);var e=l(n);a&&e||d({conversation:o,message:n,index:t,conversationId:i}),u(n)})};function Ye(n,e,t){t.forEach(function(t){if(!e.some(function(n){return n===t}))throw'Property "'.concat(t,'" is not allowed in the type "').concat(n.type,'"')})}function Ze(){return["type","conversationId","id","nextId","tag"]}function $e(n){var t=n.type;if("string"!=typeof t||""===t)throw"all messages within a conversation must be an object";if("string"!=typeof(t=n.id)||""===t)throw'all messages must have a property "id" which is a non empty string';if("string"!=typeof n.nextId)throw'all messages must a property "nextId" which is a string';if(n=n.tag,void 0!==n&&("string"!=typeof n||""===n))throw'The property "tag" must be a non empty string if it is set'}function _e(){var n=e.getOrNull("freeManager");if(null!==n){n=n.messagesLimit;if(n<c)throw'You cannot have more than "'.concat(n,'" messages for your conversation in the free edition. Upgrade to premium')}}function af(t){var n=e.getOrNull("freeManager");if(null!==n&&!n.allowedMessageTypes.some(function(n){return n===t.type}))throw'The message type "'.concat(t.type,'" is not available in the free edition. Upgrade to premium')}function cf(n){n.filter(function(n){if(null===n)return!1;var t=n[0].conversationId;return!1===s.some(function(n){return n.conversationId===t})||void 0}).forEach(function(n){t.prepareConversationOrThrow(n)})}var l=function messageContainsExtraData(n){var t="conversationId"in n,e="nextId"in n,n="id"in n;return t&&e&&n},d=function setMessageExtraData(n){var t=n.conversation,e=n.message,o=n.index,a=n.conversationId,i=null,n=o+1;n<=t.length-1&&(i=t[n]),e.conversationId=a,0===o&&(e.id="initial"),null===i?e.nextId="":(i.id=r.newUniqueId(),e.nextId=i.id)},u=function prepareMessageOrThrow(t){if(null===t||"object"!==_typeof(t))throw"All messages must be a non null object";_e(),af(t),$e(t);var n={text:o,input:i,choice:h,callback:g},e=Object.keys(n).find(function(n){return n===t.type});if(void 0===e)throw'Invalid type "'.concat(t.type,'" found in a message');(0,n[e])(t)},o=function validateTextOrThrow(n){function kg(n){return"Text message: "+n}var t=[].concat(_toConsumableArray(Ze()),["text"]),e=Object.keys(n);if(Ye(n,t,e),"string"!=typeof n.text)throw kg('property "text" must be a string')},a={},i=function validateInputOrThrow(n){function qg(n){return"Input message: "+n}var t=[].concat(_toConsumableArray(Ze()),["variable","text"]),e=Object.keys(n);Ye(n,t,e);t=n.variable;if("string"!=typeof t||""===t)throw qg('property "variable" must be a non empty string');e=n.text;if(void 0!==e&&"string"!=typeof e||""===e)throw qg('property "text" must be a non empty string');if(void 0!==a[t])throw'Variable "'.concat(t,'" already exists (In input with id "').concat(n.id,'")');a[t]=n},h=function validateChoiceOrThrow(e){function yg(n){return"Choice message: "+n}var n=[].concat(_toConsumableArray(Ze()),["options","text"]),t=Object.keys(e);Ye(e,n,t);t=e.options;if(!Array.isArray(t))throw yg('Property "options" must be an array.');t.forEach(function(n){function Fg(n){return"Option in choice message: "+n}var t=Object.keys(n);Ye(e,["text","conversation"],t);t=n.text;if("string"!=typeof t||""===t)throw Fg('property "text" must be a non empty string');n=n.conversation;if(null!==n&&!Array.isArray(n))throw Fg('property "conversation" must be an array')});t=e.options.map(function(n){return n.conversation});cf(t)},g=function validateCallbackOrThrow(n){function Ng(n){return"Callback message: "+n}var t=[].concat(_toConsumableArray(Ze()),["success","failure","callback"]),e=Object.keys(n);if(Ye(n,t,e),"function"!=typeof n.callback)throw Ng('property "callback" must be a function')}}),window.taglio_chat_app.addToLibs(function conversationQueue(n){var t=this,o=window.taglio_chat_app.libs,a=window.taglio_chat_app.instanceManager,e=(window.taglio_chat_app.staticMethods,new o.instance(t,"conversationQueue"),{}),i={},r=function _onFinishedCallback(){},s=!1,p=(n=void 0===n?{}:n).conversation;if("boolean"!=typeof(p=void 0===p?!1:p))throw"_mustLog must be a boolean";t.getConversationOrNull=function(n){return f(n)},t.listenToOnQueueFinished=function(n){if("function"!=typeof n)throw"callback must be a function";r=n},t.start=function(n){if(null===n||"object"!==_typeof(n))throw"conversation must be an object";s=!0,h(n);n=n[0];l(n)},t.conversationWasStarted=function(){return s},t.addVariable=function(n,t){if("string"!=typeof n||""===n)throw"name must be a non empty string";if("string"!=typeof t||""===t)throw"value must be a non empty string";u(n,t)},t.getAllVariables=function(){return e};var c=!(t.setConversation=function(n){return h(n)});t.endConversationOnDemand=function(){c=!0};var l=function runNextMessage(n){var t=a.get("chatLayout").getChatContentId(),e=(n.id,n.type),n=d(e,{idElementToAppendFrom:t,message:n});if(void 0===n.run)throw"Instance of type '".concat(action,'\' does not have the "run" method');n.run(function(n,t){if("string"!=typeof t)throw"nextId must be an string at this point. Make sure you set it";if("string"!=typeof n||""===n)throw"conversation must be a non empty string at this point. Make sure you set it";if(""!==t&&!0!==c){var e=g(n).find(function(n){return n.id===t});if(void 0===e)throw"No message found with id '".concat(t,"'");setTimeout(function(){runNextMessage(e)},0)}else r()})},d=function createMessageInstance(n,t){var e=null;if("text2"===n)e=new o.visitorMessage(t);else if("text"===n)e=new o.agentMessage(t);else if("input"===n)e=new o.inputMessage(t);else if("choice"===n)e=new o.choiceMessage(t);else{if("callback"!==n)throw"Invalid type => "+n;e=new o.callbackMessage(t)}if(null===e)throw"ret must be set at this point";return e},u=function addVariable(n,t){e[n]=t},h=function setConversation(n){var t=n[0].conversationId;void 0!==i[t]||(i[t]=n)},g=function getConversation(n){var t=f(n);if(null===t)throw'Conversation with id "'.concat(n,'" does not exists');return t},f=function getConversationOrNull(n){if("string"!=typeof n||""===n)throw"conversationId must be a non empty string";n=i[n];return void 0===n?null:n}}),window.taglio_chat_app.addToLibs(function freeManager(){var n=window.taglio_chat_app.libs;window.taglio_chat_app.instanceManager,new n.instance(this,"freeManager");this.messagesLimit=15,this.allowedMessageTypes=["text","input","choice"],this.allowedOptions=["appId","conversation"]}),window.taglio_chat_app.addToLibs(function messagesCommon(){var o=this,a=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager;window.taglio_chat_app.staticMethods,new a.instance(o,"messagesCommon");o.getIsTypingTimeDefault=function(){return 1500},o.addTypingMessage=function(n,t){var e=o.getIsTypingTimeDefault(),n=n.idElementToAppendFrom;new a.isTypingMessage({idElementToAppendFrom:n}).addChatTypingFor(e,t)},o.appendComponentWithAnimation=function(n,t,e){e.classList.add("js__prepareChatAppearingAnimation"),n.appendComponentNode(t,e),e.offsetWidth,e.classList.add("js__animateChatAppearingAnimation")},o.getValidatedText=function(n){var t=document.createElement("div");return t.innerHTML=n,_toConsumableArray(t.querySelectorAll("*")).forEach(function(n){i(n),p(n),l(n)}),t.innerHTML};var i=function cleanNode(t){var n={isAnchor:"A"===t.nodeName,isImage:"IMG"===t.nodeName,isBold:"B"===t.nodeName,isUnderline:"U"===t.nodeName,isItalic:"I"===t.nodeName,isNewLine:"BR"===t.nodeName,isVar:"VAR"===t.nodeName};Object.values(n).some(function(n){return n})?t.getAttributeNames().forEach(function(n){return r(t,n)}):t.remove()},r=function removeAttribute(n,t){s.some(function(n){return n.toUpperCase()===t.toUpperCase()})||n.removeAttribute(t)},s=["href","src"],p=function replaceVariables(o){"VAR"!==o.nodeName?s.forEach(function(n){var t,e=o.getAttribute(n);null!==e&&((t=document.createElement("DIV")).innerHTML=e,t.querySelectorAll("var").forEach(c),t=t.childNodes[0].nodeValue,o.setAttribute(n,t))}):c(o)},c=function replaceVarTagContent(n){var t=e.get("conversationQueue").getAllVariables()[n.innerHTML];if(void 0===t)throw'The variable "'.concat(n.innerHTML,'" was not defined.');n.outerHTML=t},l=function addTargetBlankToAnchors(n){"A"===n.nodeName&&n.setAttribute("target","_blank")}}),window.taglio_chat_app.addToLibs(function agentMessage_style(){return'\n<style id="agentMessage_style">\n\n/* Animation for chat appearing */\n.taglioChapApp_agentMessage .js__prepareChatAppearingAnimation{\n    transition: transform 0.25s linear;\n    transition: opacity 0.25s linear;\n    transform: scale(0.5);\n    opacity: 0.2;\n}\n\n.taglioChapApp_agentMessage .js__animateChatAppearingAnimation{\n    transform: scale(1);\n    opacity: 1;\n}\n\n.taglioChapApp_agentMessage .chat_agent{\n    background-color: var(--primary_color);\n    color: var(--white_color);\n}\n\n.taglioChapApp_agentMessage img{\n    width: 100%;\n    height: auto;\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function agentMessage_template(){return'\n    \n<div class="taglioChapApp_agentMessage agent">\n  <p data-el="chat_text" class="chat_item chat_agent">{message}</p>\n</div>\n\n    '}),window.taglio_chat_app.addToLibs(function agentMessage(n){var o=window.taglio_chat_app.libs,a=window.taglio_chat_app.instanceManager,i=window.taglio_chat_app.staticMethods,r=new o.instance(this,"visitorMessage-".concat(i.newUniqueId())),s=n.idElementToAppendFrom;if("string"!=typeof s||""===s)throw"invalid idElementToAppendFrom. Must be a non empty string";var p=n.message;if("object"!==_typeof(p))throw"invalid message. Must be an object";this.run=function(n){if("function"!=typeof n)throw"onDone must a function";if(""===p.text)return a.get("conversationQueue").endConversationOnDemand(),void t(n);a.get("messagesCommon").addTypingMessage({idElementToAppendFrom:s},function(){e(),t(n)})};var t=function runOnDone(n){var t=p.nextId;n(p.conversationId,t)},e=function createDom(){r.addStyle(o.agentMessage_style());var n=a.get("messagesCommon"),t=p.text,e=n.getValidatedText(t),t=o.agentMessage_template(),e=i.createDomNode(t,[{message:e}]);n.appendComponentWithAnimation(r,s,e)}}),window.taglio_chat_app.addToLibs(function callbackMessage(n){var t=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,i=(new t.instance(this,"callbackMessage-".concat(o.newUniqueId())),n.idElementToAppendFrom);if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";var r=n.message;if("object"!==_typeof(r))throw"invalid message. Must be an object";this.run=function(t){if("function"!=typeof t)throw"onDone must a function";try{a(function(n){p(n,t)})}catch(n){console.error(n),p({type:"text",text:""},t)}};var a=function runMessageCallback(e){var o=new t.isTypingMessage({idElementToAppendFrom:i}),a=performance.now();o.start(),r.callback(function(n){var t=performance.now(),t=s(a,t);o.stopAfterTime(t,function(){e(n,e)})})},s=function calculateStopRemainingTime(n,t){if("number"!=typeof n)throw"startTime must be a number";if("number"!=typeof t)throw"endTime must be a number";if(t<n)throw'Start time "'.concat(n,'" must lower than endTime "').concat(t,'" ');n=e.get("messagesCommon").getIsTypingTimeDefault()-(t-n);return n=n<=0?0:n},p=function handleCallbackResult(n,t){null!==n?(e.get("conversationManager").prepareConversationOrThrow(n,!0),e.get("conversationQueue").setConversation(n),t((n=n[0]).conversationId,n.id)):t(r.conversationId,r.nextId)}}),window.taglio_chat_app.addToLibs(function choiceMessage_style(){return'\n<style id="choiceMessage_style">\n\n.taglioChapApp_choiceMessage{\n    white-space: nowrap;\n}\n\n.taglioChapApp_choiceMessage .choiceText{\n    \n    line-height: 16px;\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 10px;\n    margin-right: 5px;\n}\n\n.taglioChapApp_choiceMessage .optionsHolder{\n    border-radius: 16px;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n}\n\n.taglioChapApp_choiceMessage .option{\n    text-align:center;\n\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n    \n    padding: 8px 12px;\n    margin:0;\n    cursor: pointer;\n\n    background-color:white;\n    color:var(--primary_color);\n    border: 1px solid var(--primary_color);\n    border-top:0;\n}\n\n.taglioChapApp_choiceMessage .question{\n    text-align:center;\n\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n    \n    padding: 8px 12px;\n    margin:0;\n\n    border-top:0;\n\n    border: 1px solid var(--primary_color);;\n    background-color:var(--primary_color);\n    color:white;\n\n    border-top-right-radius: 16px;\n    border-top-left-radius: 16px;\n}\n\n.taglioChapApp_choiceMessage .js__noEvents{\n    pointer-events: none;\n}\n\n.taglioChapApp_choiceMessage img{\n    width: 13%;\n    height: auto;\n}\n\n.taglioChapApp_choiceMessage .option:hover,\n.taglioChapApp_choiceMessage .option:focus{\n    opacity: 0.7;\n\n    background-color:var(--primary_color);\n    color:white;\n}\n\n\n.taglioChapApp_choiceMessage .optionsHolder  .option:last-child{\n    border-bottom-right-radius: 16px;\n    border-bottom-left-radius: 16px;\n}\n\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function choiceMessage_template(){return'\n    \n<div class="taglioChapApp_choiceMessage agent">\n  <div class="optionsHolder" data-el="options_holder">\n    <p class="question" data-el="option" data-conversation-id="{conversationId}">{message}</p>\n  </div>\n    \n    <template data-el="options_template">\n      <p class="option" data-el="option" data-conversation-id="{conversationId}" data-is-null="{isNull}">{text}</p>\n    </template>\n</div>\n\n    '}),window.taglio_chat_app.addToLibs(function choiceMessage(n){var i=window.taglio_chat_app.libs,r=window.taglio_chat_app.instanceManager,s=window.taglio_chat_app.staticMethods,p=new i.instance(this,"choiceMessage-".concat(s.newUniqueId())),c=n.idElementToAppendFrom;if("string"!=typeof c||""===c)throw"invalid idElementToAppendFrom. Must be a non empty string";var l=n.message;if("object"!==_typeof(l))throw"invalid message. Must be an object";this.run=function(n){if("function"!=typeof n)throw"onDone must a function";r.get("messagesCommon").addTypingMessage({idElementToAppendFrom:c},function(){e(),t(n)})};function ek(){p.findAll("option").forEach(function(n){s.mustAddClass(n,"js__noEvents",!0),n.onclick=null})}var t=function listenTo_clickOnOption(o){p.findAll("option").forEach(function(n){n.onclick=function(n){var t=n.target.closest("[data-conversation-id]"),e=(t=null===t?n.target:t).getAttribute("data-conversation-id"),n="true"===t.getAttribute("data-is-null"),t=t.innerHTML;a({conversationId:e,text:t,isNullConversation:n,goToNextMessageCallback:o})}})},a=function clickOnOption(n){var t=n.conversationId,e=n.text,o=n.isNullConversation,a=n.goToNextMessageCallback;ek();n={idElementToAppendFrom:r.get("chatLayout").getChatContentId(),text:e};new i.visitorMessage(n).runSync();e=u(t);o||r.get("conversationQueue").setConversation(e.conversation);n=l.nextId;a(t,n=!o?e.nextId:n)},e=function createDom(){p.addStyle(i.choiceMessage_style());var e=r.get("messagesCommon"),n=i.choiceMessage_template(),t=s.createDomNode(n,[{message:l.text}]),o=t.querySelector('[data-el="options_template"]').innerHTML,n=l.options.map(function(n){var t=e.getValidatedText(n.text),n=d(n.conversation),n={text:t,conversationId:n.conversationId,isNull:n.isNull};return s.createDomNode(o,[n])}),a=t.querySelector('[data-el="options_holder"]');n.forEach(function(n){return a.append(n)}),e.appendComponentWithAnimation(p,c,t)},d=function buildOptionInfoForDom(n){return null===n?{conversationId:l.conversationId,isNull:!0}:{conversationId:o(n),isNull:!1}},o=function getConversationIdFromOption(n){return n[0].conversationId},u=function getOptionConversationInfoOrNull(t){var n=l.options.find(function(n){return o(n.conversation)===t}).conversation;return void 0===n?null:{conversation:n,nextId:n[0].id}}}),window.taglio_chat_app.addToLibs(function inputMessage(n){var o=window.taglio_chat_app.libs,a=window.taglio_chat_app.instanceManager,t=window.taglio_chat_app.staticMethods,t=(new o.instance(this,"inputMessage-".concat(t.newUniqueId())),n.idElementToAppendFrom);if("string"!=typeof t||""===t)throw"invalid idElementToAppendFrom. Must be a non empty string";var i=n.message;if("object"!==_typeof(i))throw"invalid message. Must be an object";this.run=function(n){if("function"!=typeof n)throw"onDone must a function";var t,e;void 0!==i.text?(t=a.get("chatLayout").getChatContentId(),e={text:i.text},new o.agentMessage({idElementToAppendFrom:t,message:e}).run(function(){return r(n)})):r(n)};var r=function handleInput(t){var e=a.get("chatLayout");e.mustDisableTextArea(!1),e.listenToInputMessage(function(n){e.removeListenerToInputMessage(),a.get("conversationQueue").addVariable(i.variable,n),e.mustDisableTextArea(!0),t(i.conversationId,i.nextId)})}}),window.taglio_chat_app.addToLibs(function isTypingMessage_style(){return'\n<style id="isTypingMessage_style">\n\n.taglioChapApp_isTypingMessage {\n}\n\n/* Is typing animation */\n.taglioChapApp_isTypingMessage .chat-bubble {\n\n    width: fit-content;\n    justify-content: center;\n    border-radius: 16px;\n    line-height: 16px;\n    padding: 8px 12px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n\n    background-color: var(--agent_chat_color);\n    color: var(--default_text_color);\n}\n  \n.taglioChapApp_isTypingMessage .typing {\n    align-items: center;\n    display: flex;\n}\n.taglioChapApp_isTypingMessage .typing .dot {\n    animation: mercuryTypingAnimation 1.5s infinite ease-in-out;\n    background-color: var(--default_text_color); \n    border-radius: 50%;\n    height: 5px;\n    margin-right: 4px;\n    vertical-align: middle;\n    width: 5px;\n    display: inline-block;\n}\n\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(1) {\n    animation-delay: 200ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(2) {\n    animation-delay: 300ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(3) {\n    animation-delay: 400ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:last-child {\n    margin-right: 0;\n}\n\n@keyframes mercuryTypingAnimation {\n    0% {\n        transform: translateY(0px);\n        background-color:var(--default_text_color); \n    }\n    28% {\n        transform: translateY(-7px);\n        background-color:var(--default_text_color); \n    }\n    44% {\n        transform: translateY(0px);\n        background-color: var(--default_text_color); \n    }\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function isTypingMessage_template(){return'\n    \n<div class="taglioChapApp_isTypingMessage agent">\n  <div class="chat-bubble">\n  <div class="typing">&nbsp;\n    <div class="dot"></div>\n    <div class="dot"></div>\n    <div class="dot"></div>\n    &nbsp;</div>\n  </div>\n</div>\n\n    '}),window.taglio_chat_app.addToLibs(function isTypingMessage(n){var e=this,t=window.taglio_chat_app.libs,o=(window.taglio_chat_app.instanceManager,window.taglio_chat_app.staticMethods),a=new t.instance(e,"isTypingMessage-".concat(o.newUniqueId())),i=n.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";e.addChatTypingFor=function(n,t){s(),e.stopAfterTime(n,t)},e.start=function(){s()},e.stop=function(){a.destroy()};var r=!(e.stopAfterTime=function(n,t){setTimeout(function(){a.destroy(),t()},n)}),s=function createDom(){var n;r||(r=!0,a.addStyle(t.isTypingMessage_style()),n=t.isTypingMessage_template(),a.createComponentDom(i,n))}}),window.taglio_chat_app.addToLibs(function visitorMessage_style(){return'\n<style id="visitorMessage_style">\n\n.taglioChapApp_visitorMessage .chat_visitor{\n    background-color: var(--agent_chat_color);\n    color: var(--default_text_color);\n}\n\n.taglioChapApp_visitorMessage .chat_visitor img{\n    width:100%;\n    height: auto;\n}\n\n.taglioChapApp_visitorMessage{\n    display: flex;\n    justify-content: flex-end;\n}\n\n</style>\n'}),window.taglio_chat_app.addToLibs(function visitorMessage_template(){return'\n    \n<div class="taglioChapApp_visitorMessage visitor">\n  <p data-el="chat_text" class="chat_item chat_visitor">{message}</p>\n</div>\n\n    '}),window.taglio_chat_app.addToLibs(function visitorMessage(n){var e=window.taglio_chat_app.libs,o=window.taglio_chat_app.instanceManager,a=window.taglio_chat_app.staticMethods,i=new e.instance(this,"visitorMessage-".concat(a.newUniqueId())),r=n.idElementToAppendFrom;if("string"!=typeof r||""===r)throw"invalid idElementToAppendFrom. Must be a non empty string";var s=n.text;if("string"!=typeof s||""===s)throw"text must be a non empty string";this.runSync=function(){t()};var t=function createDom(){i.addStyle(e.visitorMessage_style());var n=o.get("messagesCommon"),t=e.visitorMessage_template(),t=a.createDomNode(t,[{message:s}]);n.appendComponentWithAnimation(i,r,t)}});