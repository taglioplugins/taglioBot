"use strict";window.appBuilder=function(t){let n=this;if(n.staticMethods=null,n.instanceManager=null,n.root=null,n.innerAppId=null,n.useShadowRoot=null,n.app=null,"string"!=typeof t||""===t)throw"appName must be a non empty string";let e=t;n.start=function(t){let o=t.elementIdToAppendFrom;if("string"!=typeof o||""===o)throw"elementIdToAppendFrom must be a non empty string";let a=document.getElementById(o);if(null===a)throw`elementIdToAppendFrom "${o}" does not exist wihin dom`;let i=t.useShadowRoot;if(void 0===i&&(i=!1),"boolean"!=typeof i)throw"useShadowRoot must be a boolean";n.useShadowRoot=i;let r=o+"_inner",s=document.createElement("div");if(s.id=r,s.classList.add(e),null!==document.getElementById(r))throw`Id "${r}" already exist. Please select another one for this`;n.innerAppId=r,!0===i?(n.root=a.attachShadow({mode:"open"}),n.root.append(s)):(n.root=document,n.root.getElementById(o).append(s)),window[e].root=n.root,window[e].useShadowRoot=n.useShadowRoot,window[e].innerAppId=n.innerAppId};let instance=function(t,e){let o=this,a=n.instanceManager,i=n.staticMethods;if("object"!=typeof t)throw"You must provide an object as prototype";if("string"!=typeof e||""===e)throw"You have to provide an id for the instance";if(a.exist(e))throw"Already exist an istance with id ->"+e;let r=null;o.getId=function(){return r},o.destroy=function(){let t=o.findRoot();null!==t&&t.parentNode.removeChild(t),a.remove(r)},o.querySelector=function(t){return o.findRoot().querySelector(t)},o.querySelectorAll=function(t){return o.findRoot().querySelectorAll(t)},o.addStyle=function(t){n.addStyle(t)},o.findRoot=function(){return n.root.getElementById(r)},o.find=function(t){if("string"!=typeof t||""===t)throw"elementName must be a non empty string";return n.root.getElementById(r).querySelector(`[data-el="${t}"]`)},o.findAll=function(t){if("string"!=typeof t||""===t)throw"elementName must be a non empty string";return n.root.getElementById(r).querySelectorAll(`[data-el="${t}"]`)},o.createComponentDom=function(t,n,e){let o=i.createDomNode(n,e);o.id=r,i.appendDomNode(t,o)},o.createComponentNode=function(t,n){let e=i.createDomNode(t,n);return e.id=r,e},o.appendComponentNode=function(t,n){n.id=r,i.appendDomNode(t,n)},r=e,a.add(r,t),t.instance=o},addToLibs=function(t,n,e){if("function"!=typeof e)throw"lib must be a function";let o=e.name;if(void 0===o)throw"lib name cannot be undefined";for(var a in n)if(a===o)throw"there is a lib with the same name as ->"+o;n[o]=e};n.addStyle=function(t){if("string"!=typeof t||""===t)throw"styleContent must be a non empty string";let e=function(){let t=document.createElement("div"),e=n.innerAppId+"_style",o=n.root.getElementById(e);return null!==o?o:(!0===n.useShadowRoot?n.root.append(t):n.root.getElementById(n.innerAppId).append(t),t.id=e,t)}(),o=document.createElement("div");o.innerHTML=t;let a=o.firstElementChild;if(null!==document.getElementById(a.id))throw`Already exist a style node with id "${a.id}"`;e.append(a)};let instanceManager=function(){let instanceModel=function(t,n){if("string"!=typeof t||"id"===t)throw"invalid id. It must be a non empty string";if(this.id=t,"object"!=typeof n)throw"invalid instance. It must be an object";this.instance=n},t=[];this.add=function(n,e){if(!n)throw"id must be provided";if(!e)throw"instance must be provided";let o=new instanceModel(n,e);if(t.some(t=>t.id===o.id))throw"instance already exists with name -> "+n;t.push(o)},this.get=function(n){if(!n)throw"id must be provided";let e=t.find(t=>t.id===n);if(void 0===e)throw`instance with id '${n}' does not exist`;if(void 0===e.instance)throw`instance with id '${n}' does not exist`;return e.instance},this.getOrNull=function(n){if(!n)throw"id must be provided";let e=t.find(t=>t.id===n);return void 0===e||void 0===e.instance?null:e.instance},this.exist=function(n){if(!n)throw"id must be provided";return t.some(t=>t.id===n)},this.remove=function(n){if(!n)throw"id must be provided";let e=t.findIndex(t=>t.id===n);-1!==e?t.splice(e,1):console.warn("No instance was removed with this id => "+n)},this.startsWith=function(n){if(!n)throw"selector must be provided";return t.filter(t=>!0===t.id.startsWith(n)).map(t=>t.instance)},this.getAll=function(){return t}},staticMethods=function(){let t=this;t.listenTo_clickAnywhereOutOfElement=function(t,e){n.root.addEventListener("click",(function handler(o){!0!=(null!==o.target.closest("#"+t))&&(null!==n.root.getElementById(t)?e():n.root.removeEventListener("click",handler,!0))}),!0)},t.createDom=function(n,e,o){let a=t.createDomNode(e,o);t.appendDomNode(n,a)},t.createDomNode=function(n,e){void 0===e&&(e=[]);let o=t.replaceStringWith(n,e),a=document.createElement("DIV");return a.innerHTML=o,a.firstElementChild},t.appendDomNode=function(t,e){n.root.getElementById(t).append(e)},t.mustAddClass=function(t,n,e){if(!t instanceof HTMLElement)throw"elment must be an html element";if("string"!=typeof n||""===n)throw"classNameToAdd must be a non empty string";if("boolean"!=typeof e)throw"mustAdd must be a non empty string";let o=t.classList;!0===e?o.contains(n)||o.add(n):o.remove(n)},t.toggleClass=function(t,n){if(!t instanceof HTMLElement)throw"elment must be an html element";if("string"!=typeof n||""===n)throw"classNameToToggle must be a non empty string";let e=t.classList;e.contains(n)?e.remove(n):e.add(n)},t.replaceStringWith=function(t,n){if(!Array.isArray(n))throw"objectWithKeyValues must be an array";if(void 0===t)throw"StringText to replaced is undefined. Fix it";let e=[],o=t;return n.forEach(t=>{for(let a in t){if(e.some(t=>t===a))throw console.log(n),`key '${a}' already exist. See data above`;if(null===t[a])throw`value with key ${a} is null`;let i=new RegExp(`{${a}}`,"g");o=o.replace(i,t[a]),e.push(a)}}),o};let e=1,o=0;t.newUniqueId=function(){let t=(new Date).getTime();t===o?e++:e=1;let n=`${t}-${e}`;return o=t,n},t.groupBy=function(t,n){if(!Array.isArray(t))throw"must pass an array";if(void 0===t[0][n])throw"collection must have this property to group by => "+n;return t.reduce((function(t,e){return(t[e[n]]=t[e[n]]||[]).push(e),t}),{})},t.makeHttpRequest=function(t,n){let e=t.url,o=t.headers,a=t.verb,i=t.body;if("string"!=typeof e||""===e)throw"url must be a non empty string";if(void 0===o&&(o={}),"object"!=typeof o||null===o)throw"headers must be a non null object";let r=["GET","POST"];if(!r.some(t=>t===a))throw`verb '${a}' is not a valid one. It must be either of these: ${r.join(", ")}`;if(void 0===i&&(i=""),"string"!=typeof i)throw"body must be an string";let s=new XMLHttpRequest;s.onreadystatechange=function(){if(4!==this.readyState)return;let t=s.status,e=s.responseText,o=s.getAllResponseHeaders(),a=null;try{a=JSON.parse(e)}catch(t){console.warn("Fail to parse the response of the expressions")}n({status:t,responseAsText:e,responseHeaders:o,responseAsObject:a})},s.open(a,e,!0),Object.keys(o).forEach(t=>{let n=o[t];s.setRequestHeader(t,n)}),""===i?s.send():s.send(i)}};n.app=window[e]=new function(){this.libs={},n.instanceManager=new instanceManager,this.instanceManager=n.instanceManager,n.staticMethods=new staticMethods,this.staticMethods=n.staticMethods,this.addStyle=n.addStyle,this.addToLibs=function(t){addToLibs(e,this.libs,t)},this.addToLibs(instance)}},function(){let t=new window.appBuilder("taglio_chat_app"),n=t.app,e=!1;const o="taglio_chat_app_holder";n.start=function(n){if(e)return;e=!0,createDivHolderAndAppend(),t.start({elementIdToAppendFrom:o,useShadowRoot:!0});let a=window.taglio_chat_app.libs;if(window.taglio_chat_app.addStyle(a.app_style()),null===document.getElementById(o))throw"appElement cannot be null at this point";new a.conversationQueue,new a.conversationManager,new a.messagesCommon,void 0!==a.freeManager&&new a.freeManager,throwIfFreeAndAccessToProperty(n);let i={idElementToAppendFrom:window.taglio_chat_app.innerAppId,id:"chatLayout",appOptions:n};new a.chatLayout(i)},n.getVariables=function(){return window.taglio_chat_app.instanceManager.get("conversationQueue").getAllVariables()};let createDivHolderAndAppend=function(){let t=document.createElement("DIV");t.id=o,document.body.append(t)},throwIfFreeAndAccessToProperty=function(t){let n=window.taglio_chat_app.instanceManager.getOrNull("freeManager");if(null===n)return;let e=n.allowedOptions,o=Object.keys(t).every(t=>e.some(n=>n===t)),a=e.join(", ");if(!o)throw`you can only use these options: "${a}" in the free edition when starting the chat. Upgrade to premium`};window.taglio_chat_app.version="1.0.0",console.log(window.taglio_chat_app.version)}(),window.taglio_chat_app.addToLibs((function app_style(){return"\n<style id=\"app_style\">\n    \n\n.taglioChapApp_chatLayout_wrapper {\n    /* Width of chat */\n    --chat-width: 352px;\n\n    /* Primary color */\n    --primary_color: rgb(31, 115, 183);\n    --agent_chat_color:  rgb(233, 235, 237);\n    --default_text_color: #2f3941;\n    --white_color: rgb(255, 255, 255);\n    --gray_color: rgb(104, 115, 125);\n    --soft_gray_color: rgb(216, 220, 222);\n    --box_gray_color: rgba(104, 115, 125, 0.35) 0px 0px 0px 3px;\n}\n\n.taglioChapApp_chatLayout_wrapper .chat_item{\n    white-space: pre-wrap;\n    border-radius: 16px;\n    line-height: 16px;\n    padding: 8px 12px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n}\n\n/* Animation for chat appearing */\n.taglioChapApp_chatLayout_wrapper .js__prepareChatAppearingAnimation{\n    transition: transform 0.25s linear;\n    transition: opacity 0.25s linear;\n    transform: scale(0.5);\n    opacity: 0.2;\n}\n\n.taglioChapApp_chatLayout_wrapper .js__animateChatAppearingAnimation{\n    transform: scale(1);\n    opacity: 1;\n}\n\n.taglioChapApp_chatLayout_wrapper var{\n    font-style: normal;\n}\n\n.taglioChapApp_chatLayout_wrapper a{\n    font-style: normal;\n    color: yellow;\n}\n\n.taglioChapApp_chatLayout_wrapper br{\n    content: ' ';\n    display: flex;\n    margin-bottom: 10px;\n\n}\n\n.taglioChapApp_chatLayout_wrapper div.icon svg{\n    width: 1em;\n}\n\n.taglioChapApp_chatLayout_wrapper div.icon{\n    display: inline-flex;\n}\n\n</style>\n"})),window.taglio_chat_app.addToLibs((function chatLayout_style(){return'\n<style id="chatLayout_style">\n\nbody{\n    margin: 0;\n}\n\n.taglioChapApp_chatLayout_wrapper{\n    position: fixed;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__right{\n    bottom: 15px;\n    left: auto;\n    top: auto;\n    right: 15px;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__left{\n    bottom: 15px;\n    left: 15px;\n    top: auto;\n    right: auto;\n}\n\n.taglioChapApp_chatLayout{\n    \n    min-width: 320px;\n    min-height: 450px;\n\n    width: var(--chat-width);\n    display: flex;\n    flex-direction: column;\n\n    box-sizing: border-box;\n    line-height: 20px;\n    color: var(--default_text_color);\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n    font-size: 14px;\n    border-radius: 8px;\n    box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px;\n    background-color:var(--white_color);\n    /* user-select: none; */\n}\n\n.taglioChapApp_chatLayout .header{\n    border-top-right-radius: 8px;\n    border-top-left-radius: 8px;\n\n    font-size: 15px;\n    background: var(--primary_color);\n    color: var(--white_color);\n    display: flex;\n}\n\n/* Header */\n.taglioChapApp_chatLayout .header_in_center{\n    /* Padding of whole header */\n    padding: 12px 0;\n    margin: 0 8px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.taglioChapApp_chatLayout .header_icon{\n    padding: 12px 0;\n}\n\n.taglioChapApp_chatLayout .header_in_common{\n    flex: 1;\n}\n\n.taglioChapApp_chatLayout .header_in_center{\n    font-weight: bold;\n    display: flex;\n    justify-content: center;\n    flex: 10;\n}\n\n.taglioChapApp_chatLayout .header_in_right{\n    display: flex;\n    justify-content: flex-end;\n}\n\n/* Header: icons */\n.taglioChapApp_chatLayout .header_icon{\n    font-size: 13px;\n    padding-right: 9px;\n    padding-left: 9px;\n    cursor: pointer;\n}\n\n.taglioChapApp_chatLayout .header_icon:hover,\n.taglioChapApp_chatLayout .header_icon:focus{\n    opacity: 0.7;\n    transform: scale(1.1);\n}\n\n.taglioChapApp_chatLayout .header_icon_spacer{\n    margin-right: 13px;\n    padding: 0;\n}\n\n/* Inner header */\n.taglioChapApp_chatLayout .inner_header{\n    padding: 12px 16px;\n    display: flex;\n    box-shadow: rgba(0, 0, 0, 0.1) 0px 6px 12px 0px;\n}\n\n.taglioChapApp_chatLayout .inner_header_icon_wrapper_2{\n    font-size: 30px;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .inner_header_right{\n    margin-left: 10px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    width: 85%;\n}\n\n.taglioChapApp_chatLayout .inner_header_text{\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    \n    line-height: 16px;\n    margin: 0;\n}\n\n.taglioChapApp_chatLayout .inner_header_text:first-child{\n    font-weight: bold;\n}\n\n/* Content */\n.taglioChapApp_chatLayout .content{\n    overflow: auto;\n    height: 280px;\n    display: flex;\n    flex-direction: column;\n    padding: 15px 20px;\n}\n\n.taglioChapApp_chatLayout .chat_notification{\n    align-self: center;\n    white-space: pre-wrap;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    padding: 12px 0;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .chat_visitor_alias{\n    align-self: flex-start;\n    white-space: pre-wrap;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-left: 7px;\n    margin-bottom: 8px;\n    color: var(--gray_color);\n}\n\n.taglioChapApp_chatLayout .chat_separator{\n    padding-top: 7px;\n    margin: 0;\n}\n/* Input */\n.taglioChapApp_chatLayout .input{\n    display: flex;\n    flex-direction: column;\n    padding: 15px 20px 10px 20px;\n}\n\n.taglioChapApp_chatLayout .input_textarea{\n    appearance: none;\n    border: 1px solid;\n    border-color: var(--soft_gray_color);\n    border-radius: 4px;\n    width: 100%;\n    box-sizing: border-box;\n    vertical-align: middle;\n    padding: 10px 12px;\n    line-height: 1.28571;\n    background-color: var(--white_color);\n    color: var(--default_text_color);\n    resize: none;\n    overflow: auto;\n    cursor: auto;\n    height: 75px;\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n}\n\n.taglioChapApp_chatLayout .input_textarea::placeholder {\n    opacity: 0.6;\n}\n\n.taglioChapApp_chatLayout .input_textarea:focus{\n    border-color: var(--gray_color);\n    box-shadow: var(--box_gray_color);\n    outline: none;\n}\n.taglioChapApp_chatLayout .input_textarea:hover{\n    border-color: var(--default_text_color);\n}\n\n/* Input : footer icons */\n.taglioChapApp_chatLayout .icon_group{\n    margin-top: 13px;\n    display: flex;\n    justify-content: space-between;\n    line-height: 1;\n    align-items: center;\n}\n\n.taglioChapApp_chatLayout .footer_icon{\n    cursor: pointer;\n    vertical-align: middle;\n    position: relative;\n}\n\n.taglioChapApp_chatLayout .iconWrapper{\n    position: relative;\n    padding: 5px;\n    display: flex;\n}\n\n.taglioChapApp_chatLayout .footer_icon:hover,\n.taglioChapApp_chatLayout .footer_icon:focus{\n    opacity: 0.7;\n    transform: scale(1.1);\n}\n\n  /* Separation between chats */\n  .taglioChapApp_chatLayout .agent + .visitor{\n      margin-top: 20px;\n  }\n  .taglioChapApp_chatLayout .visitor + .agent{\n      margin-top: 20px;\n  }\n\n  /* Button to hide */\n\n.taglioChapApp_chatLayout_wrapper .buttonHelpIcon{\n    font-size: 20px;\n}\n\n.taglioChapApp_chatLayout_wrapper .buttonHelpText{\n    margin: 0;\n    margin-left: 8px;\n    \n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.taglioChapApp_chatLayout_wrapper .showButton{\n    display:flex;\n    padding: 13px 22px;\n    background-color:var(--primary_color);\n    font-size: 15px;\n    color: white;\n    border-radius: 25px;\n    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,Arial,sans-serif;\n    font-weight:bold;\n    cursor: pointer;\n    box-sizing: border-box;\n    max-width: 150px;\n}\n\n  /* Button to hide default: show is hidden by default */\n.taglioChapApp_chatLayout_wrapper .showButton{\n    display:none;\n}\n\n.taglioChapApp_chatLayout_wrapper .taglioChapApp_chatLayout{\n    display:flex;\n}\n\n/* Button to hide "show button": */\n.taglioChapApp_chatLayout_wrapper.js__showButton .showButton{\n    display:flex;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__showButton .taglioChapApp_chatLayout{\n    display:none;\n}\n\n/* Send button */\n.taglioChapApp_chatLayout .textAreaWrapper{\n    position: relative;\n}\n\n.taglioChapApp_chatLayout .sendIcon{\n    position: absolute;\n    top: 50%;\n    right: 0;\n    padding: 18px;\n    font-size: 18px;\n    transform: translateY(-50%);\n    cursor: pointer;\n    \n    border-radius: 50%;\n    margin-right:5px;\n}\n\n.taglioChapApp_chatLayout .sendIcon:hover{\n    background-color: var(--primary_color);\n    color: var(--white_color);\n}\n\n.taglioChapApp_chatLayout .input_textarea{\n    padding-right: 65px;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar-track{\n\t-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n\tbackground-color: #F5F5F5;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar{\n\twidth: 10px;\n\tbackground-color: #F5F5F5;\n}\n\n.taglioChapApp_chatLayout .input_textarea::-webkit-scrollbar-thumb{\n\tbackground-color: #000000;\n\tborder: 2px solid #555555;\n}\n\n/* Avatar */\n.taglioChapApp_chatLayout_wrapper.js__showAvatar .avatarDefault{\n    display: none;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__showAvatar .avatar{\n    display: flex;\n}\n\n.taglioChapApp_chatLayout_wrapper .avatar{\n    display:none;\n    width: 30px;\n    max-height: 30px;\n    align-self: center;\n}\n\n/* callout */\n.taglioChapApp_chatLayout_wrapper .speech_alert{\n    width: 20px;\n    height: 20px;\n    border: 2px solid white;\n    border-radius: 12px;\n    font-size:12px;\n\n    background: #fff;\n    color: #000;\n    text-align: center;\n    background: red;\n    color: white;\n    top: -3px;\n    right: -8px;\n    position: absolute;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__hideInitialMesage .box2-wrapper{\n    display:none;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__hideInitialMesage .speech_alert{\n    display:none;\n}\n\n.taglioChapApp_chatLayout_wrapper .box2-wrapper{\n    cursor: pointer;\n    position: relative;\n}\n\n.taglioChapApp_chatLayout_wrapper .box2 {\n    bottom:0;\n    border-radius:5px;\n    margin-bottom: 10px;\n    border: 2px solid var(--primary_color);\n    padding: 10px;\n    text-align: center;\n    color: var(--default_text_color);\n    font-family: arial;\n    position:absolute;\n    width:170px;\n    box-shadow: rgba(0, 0, 0, 0.4) 0px 0px 10px 0px;\n    word-break: break-word;\n    background: white;\n}\n\n.taglioChapApp_chatLayout_wrapper .sb9:before {\n  content: "";\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid var(--primary_color);\n  border-bottom: 12px solid transparent;\n  right: 50%;\n  bottom: -23px;\n}\n\n.taglioChapApp_chatLayout_wrapper .sb9:after {\n  content: "";\n  width: 0px;\n  height: 0px;\n  position: absolute;\n  border-left: 10px solid transparent;\n  border-right: 10px solid transparent;\n  border-top: 10px solid #fff;\n  border-bottom: 10px solid transparent;\n  right: 50%;\n  bottom: -18px;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__right .box2{\n    right: 0;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__right .sb9:before{\n    right:10%;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__right .sb9:after{\n    right:10%;\n}\n\n\n.taglioChapApp_chatLayout_wrapper.js__right .speech_alert{\n    left: -8px;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__left{\n}\n\n.taglioChapApp_chatLayout_wrapper.js__left .sb9:before{\n    right:80%;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__left .sb9:after{\n    right:80%;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__hideCallout .box2-wrapper {\n    display: none;\n}\n\n.taglioChapApp_chatLayout_wrapper.js__hideCallout .speech_alert {\n    display: none;\n}\n\n/* Footer anchor */\n.taglioChapApp_chatLayout_wrapper .footerAnchor{\n    display:inline-flex;\n    text-decoration: none;\n    color: var(--default_text_color);\n    transition: transform 0.1s;\n    font-size:12px;\n}\n.taglioChapApp_chatLayout_wrapper .footerAnchor:hover{\n    transform: scale(1.1);\n}\n\n.taglioChapApp_chatLayout_wrapper.js__hideLogo .footerAnchor{\n    visibility:hidden;\n}\n\n/* Movil layout */\n@media only screen and (max-width: 800px) {\n    .taglio_chat_app{\n        position:fixed;\n        z-index: 999999999999;\n    }\n    .taglioChapApp_chatLayout{\n        width: 100%;\n        height: 100vh;\n        position: fixed;\n        left: 0;\n        top: 0;\n        border-radius: 0;\n    }\n    \n    .taglioChapApp_chatLayout_wrapper{\n        \n    }\n\n    .taglioChapApp_chatLayout .header {\n        border-top-right-radius: 0;\n        border-top-left-radius: 0;\n    }\n    .taglioChapApp_chatLayout .content{\n        height: 100%;\n    }\n}\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function chatLayout_template(){return'\n    \n<div class="taglioChapApp_chatLayout_wrapper js__showButton js__hideCallout">\n\n  <div class="box2-wrapper" data-el="initial_message">\n    <div class="box2 sb9" data-el="message">{initialMessage}</div>\n  </div>\n\n  <div data-el="show_button" class="showButton">\n    <div class="speech_alert" style="">1</div>\n    <div class="buttonHelpIcon icon">\n      <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="question-circle" class="svg-inline--fa fa-question-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 448c-110.532 0-200-89.431-200-200 0-110.495 89.472-200 200-200 110.491 0 200 89.471 200 200 0 110.53-89.431 200-200 200zm107.244-255.2c0 67.052-72.421 68.084-72.421 92.863V300c0 6.627-5.373 12-12 12h-45.647c-6.627 0-12-5.373-12-12v-8.659c0-35.745 27.1-50.034 47.579-61.516 17.561-9.845 28.324-16.541 28.324-29.579 0-17.246-21.999-28.693-39.784-28.693-23.189 0-33.894 10.977-48.942 29.969-4.057 5.12-11.46 6.071-16.666 2.124l-27.824-21.098c-5.107-3.872-6.251-11.066-2.644-16.363C184.846 131.491 214.94 112 261.794 112c49.071 0 101.45 38.304 101.45 88.8zM298 368c0 23.159-18.841 42-42 42s-42-18.841-42-42 18.841-42 42-42 42 18.841 42 42z"></path></svg>\n    </div>\n    <p class="buttonHelpText">{chatTitle}</p>\n     \n  </div>\n  \n  <div class="taglioChapApp_chatLayout">\n\n    <div class="header">\n      <div class="header_in_common header_in_left"></div>\n      <div class="header_in_common header_in_center">{chatTitle}</div>\n      <div class="header_in_common header_in_right">\n        <div class="icon header_icon" data-el="minimize">\n          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="window-minimize" class="svg-inline--fa fa-window-minimize fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M464 352H48c-26.5 0-48 21.5-48 48v32c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-32c0-26.5-21.5-48-48-48z"></path></svg>\n         </div>\n        <i class="header_icon header_icon_spacer"></i>\n      </div>\n    </div>\n\n    <div class="inner_header">\n      <div class="icon inner_header_icon_wrapper_2">\n        <img data-el="avatar" class="avatar" />\n        <svg class="avatarDefault" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-circle" class="svg-inline--fa fa-user-circle fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"></path></svg>\n      </div>\n      <div class="inner_header_right">\n          <p class="inner_header_text">{name}</p>\n          <p class="inner_header_text">{email}</p>\n      </div>\n    </div>\n\n    <div class="content" data-el="chat_content">\n    </div>\n\n    <div class="input"> \n      <div class="textAreaWrapper">\n        <textarea data-el="input_textarea" class="input_textarea" placeholder="Escriba un mensaje aqui..."></textarea>\n        <div class="icon sendIcon">\n          <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="paper-plane" class="svg-inline--fa fa-paper-plane fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"></path></svg>\n        </div>\n      </div>\n      \n      <div class="icon_group">\n        <div class="icon_group_left" data-el="footer_anchor">\n        <a href="https://taglioplugins.com/" class="footerAnchor" target="_blank"> &#127775; tagliobot</a>\n        </div>\n        <div class="icon_group_right">\n          <div class="iconWrapper">\n            <div class="footer_icon icon" data-el="footer_options" id="footer_options_holder">\n              <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="ellipsis-h" class="svg-inline--fa fa-ellipsis-h fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"></path></svg>\n            </div>\n            <div id="footerMenuHolder"></div>\n          </div>          \n        </div>\n      </div>\n    </div>\n\n  </div>\n\n  <script type="text/template" data-el="chat_notification">\n    <p class="chat_notification">{message}</p>\n  <\/script>\n\n</div>\n\n    '})),window.taglio_chat_app.addToLibs((function chatLayout(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=this,i=new n.instance(a,"chatLayout"),r=window.taglio_chat_app.root,s=t.idElementToAppendFrom;if("string"!=typeof s||""===s)throw"invalid idElementToAppendFrom. Must be a non empty string";let p=t.appOptions;if("object"!=typeof p)throw"must pass appOptions";let l=p.title;if(void 0===l&&(l="Support"),"string"!=typeof l||""===l)throw"invalid chatTitle. Must be a non empty string";let d=p.name;if(void 0===d&&(d="Robot"),"string"!=typeof d||""===d)throw"invalid name. Must be a non empty string";let c=p.email;if(void 0===c&&(c=""),"string"!=typeof c)throw"invalid email. Must be a non empty string";let h=p.avatar;if(void 0===h&&(h=null),null!==h&&"string"!=typeof h||""===h)throw"invalid avatar. Must be a non empty string";let u=p.initialMessage;if(void 0===u&&(u=""),"string"!=typeof u)throw"invalid initialMessage. Must be a non empty string";let g=p.hideLogo;if(void 0===g&&(g=!1),"boolean"!=typeof g)throw"invalid hideLogo. Must be a boolean";let f=p.position,m={right:"js__right",left:"js__left"};if(void 0===f&&(f="right"),"string"!=typeof f||""===f)throw"invalid position. Must be a non empty string";if(!Object.keys({right:"right",left:"left"}).some(t=>t===f))throw`Position "${f}" is invalid. It must be either "left" or "right"`;let _=p.primaryColor;if(void 0===_&&(_="rgb(31, 115, 183)"),"string"!=typeof _||""===_)throw"invalid primary color. Must be a non empty string";let w=null;function chatLayoutModel(t){if("string"!=typeof t)throw"textAreaValue must be an string";this.textAreaValue=t}a.addChatNotification=function(t){addChatNotification(t)},a.getChatContentId=function(){return w},a.mustDisableTextArea=function(t){mustDisableTextArea(t)};let y=null;a.listenToInputMessage=function(t){y=t},a.removeListenerToInputMessage=function(){y=null},a.loadConversation=function(){let t=p.conversation;e.get("conversationManager").prepareConversationOrThrow(t);let n=e.get("conversationQueue");n.listenToOnQueueFinished((function(){e.get("chatLayout").addChatNotification("Session ended")})),n.start(t)};let listenTo_onWindowsLoad=function(){document.addEventListener("DOMContentLoaded",onWindowsLoaded)},onWindowsLoaded=function(){let t=null!==localStorage.getItem("taglioRestartConversation");localStorage.removeItem("taglioRestartConversation"),t&&(mustHideInitialMessage(!0),startConversationIfNotStarted())},listenTo_onNodeAppended=function(){var t=i.find("chat_content");new MutationObserver((function(t){t.forEach((function(t){i.querySelectorAll("img").forEach(t=>t.onload=()=>onNodeAppended()),onNodeAppended()}))})).observe(t,{attributes:!1,childList:!0,characterData:!1})},onNodeAppended=function(){var t=i.find("chat_content");t.scrollTop=t.scrollHeight},listenTo_clickOnShowButton=function(){i.find("show_button").onclick=clickOnShowButton},listenTo_clickOnCallout=function(){i.find("initial_message").onclick=clickOnShowButton},clickOnShowButton=function(){mustHideInitialMessage(!0),startConversationIfNotStarted()},startConversationIfNotStarted=function(){showButton(!1),!1===e.get("conversationQueue").conversationWasStarted()&&a.loadConversation()},listenTo_clickOnMinimize=function(){i.find("minimize").onclick=clickOnMinimize},clickOnMinimize=function(){showButton(!0)},listenTo_clickOnFooterOptions=function(){i.find("footer_options").onclick=clickOnFooterOptions},clickOnFooterOptions=function(){e.get("footerMenu").show()},listenTo_onReturnKeyUp=function(){i.find("input_textarea").onkeyup=function(t){"Enter"===t.code&&(t.preventDefault(),onReturnKeyPressed())}},onReturnKeyPressed=function(){let t=getModel();""!==t.textAreaValue.trim()&&addVisitorMessage(t.textAreaValue)},listenTo_onReturnKeyDown=function(){i.find("input_textarea").onkeydown=function(t){"Enter"===t.code&&t.preventDefault()}},buildAvatar=function(t){if(null===h)return;o.mustAddClass(t,"js__showAvatar",!0),t.querySelector('[data-el="avatar"]').setAttribute("src",sanitizeHtml(h))},sanitizeHtml=function(t){let n=document.createElement("DIV");return n.innerHTML=t,n.innerText},showButton=function(t){let n=i.findRoot();o.mustAddClass(n,"js__showButton",t)},createChatContentId=function(){let t=i.find("chat_content"),n=i.getId();w=n+"-chatContent",t.id=w},addChatNotification=function(t){let n=i.find("chat_notification").innerHTML;o.createDom(w,n,[{message:t}])},addVisitorMessage=function(t){let e={idElementToAppendFrom:a.getChatContentId(),text:t};new n.visitorMessage(e).runSync(),null!==y&&y(t),setModel(new chatLayoutModel(""))},cleanChatContent=function(){r.getElementById(w).innerHTML=""},getModel=function(){return new chatLayoutModel(i.find("input_textarea").value)},setModel=function(t){i.find("input_textarea").value=t.textAreaValue},mustDisableTextArea=function(t){t?i.find("input_textarea").onkeyup=null:listenTo_onReturnKeyUp()},setPrimaryColor=function(){let t=`\n        <style id="primaryColor">\n            .taglioChapApp_chatLayout_wrapper {\n                ${`--primary_color: ${_};`}\n            }\n        </style>\n        `;i.addStyle(t)},setWidgetPosition=function(){let t=m[f];o.mustAddClass(i.findRoot(),t,!0)},hideLogoIfApplies=function(){o.mustAddClass(i.findRoot(),"js__hideLogo",g)},setInitialMessageIfApplies=function(){if(""===u)return;o.mustAddClass(i.findRoot(),"js__hideCallout",!1);let t=a.getChatContentId(),e={type:"text",text:u};new n.agentMessage({message:e,idElementToAppendFrom:t}).addMessage()},mustHideInitialMessage=function(t){o.mustAddClass(i.findRoot(),"js__hideInitialMesage",t)},shortenInitialMessage=function(){let t=u.substring(0,100);return u.length>100?t+"...":u};!function(){i.addStyle(n.chatLayout_style());let t=n.chatLayout_template(),e={chatTitle:sanitizeHtml(l),name:sanitizeHtml(d),email:sanitizeHtml(c),initialMessage:shortenInitialMessage(u)},o=i.createComponentNode(t,[e]);buildAvatar(o),i.appendComponentNode(s,o),new n.footerMenu({idElementToAppendFrom:"footerMenuHolder"}),createChatContentId(),cleanChatContent(),listenTo_onReturnKeyUp(),listenTo_onReturnKeyDown(),listenTo_onNodeAppended(),listenTo_clickOnShowButton(),listenTo_clickOnCallout(),listenTo_clickOnMinimize(),listenTo_clickOnFooterOptions(),listenTo_onWindowsLoad(),a.mustDisableTextArea(!0),setPrimaryColor(),setWidgetPosition(),hideLogoIfApplies(),setInitialMessageIfApplies()}()})),window.taglio_chat_app.addToLibs((function footerMenu_style(){return'\n<style id="footerMenu_style">\n/* Footer menu */\n.taglioChapApp_footerMenu{\n    position:absolute;\n    background-color: var(--white_color);\n    border-radius:8px;\n    bottom: 100%;\n    right: 0;\n    width: auto;\n    height: auto;\n    box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 10px 0px;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem{\n    margin: 0;\n    padding: 12px 17px;\n    white-space:nowrap;\n    cursor: pointer;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover,\n.taglioChapApp_footerMenu .footerMenuItem:focus\n{\n    color: var(--white_color);\n    background-color: var(--primary_color);\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover:first-child,\n.taglioChapApp_footerMenu .footerMenuItem:focus:first-child\n{\n    border-top-right-radius:8px;\n    border-top-left-radius:8px;\n}\n\n.taglioChapApp_footerMenu .footerMenuItem:hover:last-child,\n.taglioChapApp_footerMenu .footerMenuItem:focus:last-child\n{\n    border-bottom-right-radius:8px;\n    border-bottom-left-radius:8px;\n}\n\n.taglioChapApp_footerMenu.js__hideFooterMenu{\n    display: none;\n}\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function footerMenu_template(){return'\n  <div class="taglioChapApp_footerMenu js__hideFooterMenu">\n    <p data-el="option" data-method="restartConversation" class="footerMenuItem">Restart conversation</p>\n    <p data-el="option" data-method="endConversation" class="footerMenuItem">End conversation</p>\n  </div>\n    '})),window.taglio_chat_app.addToLibs((function footerMenu(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=new n.instance(this,"footerMenu"),i=t.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";this.show=function(){mustHideFooterMenu(!1),listenTo_clickOnAnywhereOutOfFooterOptions()};let listenTo_clickOnAnywhereOutOfFooterOptions=function(){o.listenTo_clickAnywhereOutOfElement(a.getId(),clickOnAnywhereOutOfFooterOptions)},clickOnAnywhereOutOfFooterOptions=function(){mustHideFooterMenu(!0)},listenTo_clickOnOption=function(){a.findAll("option").forEach(t=>{t.onclick=t=>{let n=t.target.getAttribute("data-method");if(void 0===n)throw"There is an option with no data-method attribute defined";clickOnOption(n)}})},clickOnOption=function(t){let n={restartConversation:restartConversation,endConversation:endConversation}[t];if(void 0===n)throw`Method to run "${t}" is not defined in the valid methods to run`;n(),mustHideFooterMenu(!0)},restartConversation=function(){localStorage.setItem("taglioRestartConversation","1"),window.location.reload()},endConversation=function(){console.log("endConversation"),e.get("conversationQueue").endConversationOnDemand()},mustHideFooterMenu=function(t){let n=a.findRoot();o.mustAddClass(n,"js__hideFooterMenu",t)};!function(){a.addStyle(n.footerMenu_style());let t=n.footerMenu_template();a.createComponentDom(i,t),listenTo_clickOnOption()}()})),window.taglio_chat_app.addToLibs((function conversationManager(){let t=this,n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=(new n.instance(t,"conversationManager"),[]),i={},r=0,s=0;function processConversationsModel(t,n){if("string"!=typeof t||""===t)throw"id must be a non empty string";if(this.conversationId=t,!Number.isInteger(n)||n<=0)throw"length must be an integer higher than zero";this.length=n}t.getConversations=function(){return i},t.prepareConversationOrThrow=function(t){if(!Array.isArray(t))throw"conversation must be an array";let n=o.newUniqueId();if(a.push(new processConversationsModel(n,t.length)),r+=t.length,s>r)throw`You overpass the number of "${r}"`;t.forEach((e,o)=>{s++,handleEachMessage({conversation:t,conversationId:n,message:e,index:o})}),i[n]=t};let handleEachMessage=function(t){const{conversation:n,conversationId:e,message:o,index:a}=t;if(null===o)return prepareMessageOrThrow(o);setMessageExtraData({conversation:n,message:o,index:a,conversationId:e}),prepareMessageOrThrow(o)},setMessageExtraData=function(t){const{conversation:n,message:e,index:a,conversationId:i}=t;if(function(t){return"conversationId"in t&&"nextId"in t&&"id"in t}(e))return;let r=n[a+1];void 0===r&&(r=null);let s=n[a-1];void 0===s&&(s=null),e.conversationId=i;let p=null!==r&&void 0!==r.id,l=o.newUniqueId();p&&(l=r.id);let d={initial:0===a,middle:null!==s&&null!==r,last:null!==s&&null===r};if(1!==Object.values(d).filter(t=>t).length)throw console.log(d),"More than on case found for handling messages";if(d.initial)e.id="initial-"+o.newUniqueId(),e.nextId=null===r?"":l;else if(d.middle)e.id=s.nextId,e.nextId=l;else{if(!d.last)throw"No cases were run";e.id=s.nextId,e.nextId=""}},throwIfNotAllowedFields=function(t,n,e){e.forEach(e=>{if(!n.some(t=>t===e))throw`Property "${e}" is not allowed in the type "${t.type}"`})},prepareMessageOrThrow=function(t){if(null===t||"object"!=typeof t)throw"All messages must be a non null object";!function(){let t=e.getOrNull("freeManager");if(null===t)return;let n=t.messagesLimit;if(s>n)throw`You cannot have more than "${n}" messages for your conversation in the free edition. Upgrade to premium`}(),function(t){let n=e.getOrNull("freeManager");if(null!==n&&!n.allowedMessageTypes.some(n=>n===t.type))throw`The message type "${t.type}" is not available in the free edition. Upgrade to premium`}(t),function(t){let n=t.type;if("string"!=typeof n||""===n)throw"all messages within a conversation must be an object";let e=t.id;if("string"!=typeof e||""===e)throw'all messages must have a property "id" which is a non empty string';if("string"!=typeof t.nextId)throw'all messages must a property "nextId" which is a string';let o=t.tag;if(void 0!==o&&("string"!=typeof o||""===o))throw'The property "tag" must be a non empty string if it is set'}(t);let n={text:validateTextOrThrow,input:validateInputOrThrow,choice:validateChoiceOrThrow,callback:validateCallbackOrThrow},o=Object.keys(n).find(n=>n===t.type);if(void 0===o)throw`Invalid type "${t.type}" found in a message`;(0,n[o])(t)},validateTextOrThrow=function(t){let n=["type","conversationId","id","nextId","tag","text"],e=Object.keys(t);if(throwIfNotAllowedFields(t,n,e),"string"!=typeof t.text)throw function(t){return"Text message: "+t}('property "text" must be a string')},p={},validateInputOrThrow=function(t){let error=function(t){return"Input message: "+t},n=["type","conversationId","id","nextId","tag","variable","text"],e=Object.keys(t);throwIfNotAllowedFields(t,n,e);let o=t.variable;if("string"!=typeof o||""===o)throw error('property "variable" must be a non empty string');let a=t.text;if(void 0!==a&&"string"!=typeof a||""===a)throw error('property "text" must be a non empty string');p[o]=t},validateChoiceOrThrow=function(n){let e=["type","conversationId","id","nextId","tag","options","text"],o=Object.keys(n);throwIfNotAllowedFields(n,e,o);let i=n.options;if(!Array.isArray(i))throw function(t){return"Choice message: "+t}('Property "options" must be an array.');i.forEach(t=>{let errorOption=function(t){return"Option in choice message: "+t},e=Object.keys(t);throwIfNotAllowedFields(n,["text","conversation"],e);let o=t.text;if("string"!=typeof o||""===o)throw errorOption('property "text" must be a non empty string');let a=t.conversation;if(null!==a&&!Array.isArray(a))throw errorOption('property "conversation" must be an array')}),function(n){n.filter(t=>{if(null===t)return!1;let n=t[0].conversationId;return!1===a.some(t=>t.conversationId===n)||void 0}).forEach(n=>{t.prepareConversationOrThrow(n)})}(n.options.map(t=>t.conversation))},validateCallbackOrThrow=function(t){let n=["type","conversationId","id","nextId","tag","success","failure","callback"],e=Object.keys(t);if(throwIfNotAllowedFields(t,n,e),"function"!=typeof t.callback)throw function(t){return"Callback message: "+t}('property "callback" must be a function')}})),window.taglio_chat_app.addToLibs((function conversationQueue(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=(window.taglio_chat_app.staticMethods,new n.instance(this,"conversationQueue"),{}),_onFinishedCallback=function(){},a=!1;void 0===t&&(t={});let i=t.conversation;if(void 0===i&&(i=!1),"boolean"!=typeof i)throw"_mustLog must be a boolean";this.listenToOnQueueFinished=function(t){if("function"!=typeof t)throw"callback must be a function";_onFinishedCallback=t},this.start=function(t){if(null===t||"object"!=typeof t)throw"conversation must be an object";a=!0;let n=t[0];runNextMessage(n)},this.conversationWasStarted=()=>a,this.addVariable=function(t,n){if("string"!=typeof t||""===t)throw"name must be a non empty string";if("string"!=typeof n||""===n)throw"value must be a non empty string";addVariable(t,n)},this.getAllVariables=function(){return o};let r=!1;this.endConversationOnDemand=function(){r=!0};let runNextMessage=function(t){let n=e.get("chatLayout").getChatContentId(),o=(t.id,{idElementToAppendFrom:n,message:t}),a=t.type,i=createMessageInstance(a,o);if(void 0===i.run)throw`Instance of type '${action}' does not have the "run" method`;i.run((function(t,n){if("string"!=typeof n)throw"nextId must be an string at this point. Make sure you set it";if("string"!=typeof t||""===t)throw"conversation must be a non empty string at this point. Make sure you set it";if(""===n||!0===r)return void _onFinishedCallback();let e=getConversation(t).find(t=>t.id===n);if(void 0===e)throw`No message found with id '${n}'`;setTimeout(()=>{runNextMessage(e)},0)}))},createMessageInstance=function(t,e){let o=null;if("text2"===t)o=new n.visitorMessage(e);else if("text"===t)o=new n.agentMessage(e);else if("input"===t)o=new n.inputMessage(e);else if("choice"===t)o=new n.choiceMessage(e);else{if("callback"!==t)throw"Invalid type => "+t;o=new n.callbackMessage(e)}if(null===o)throw"ret must be set at this point";return o},addVariable=function(t,n){o[t]=n},getConversation=function(t){let n=getConversationOrNull(t);if(null===n)throw`Conversation with id "${t}" does not exists`;return n},getConversationOrNull=function(t){if("string"!=typeof t||""===t)throw"conversationId must be a non empty string";let n=getConversations()[t];return void 0===n?null:n},getConversations=()=>e.get("conversationManager").getConversations()})),window.taglio_chat_app.addToLibs((function freeManager(){let t=window.taglio_chat_app.libs;window.taglio_chat_app.instanceManager,new t.instance(this,"freeManager");this.messagesLimit=15,this.allowedMessageTypes=["text","input","choice"],this.allowedOptions=["conversation"]})),window.taglio_chat_app.addToLibs((function messagesCommon(){let t=this,n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager;window.taglio_chat_app.staticMethods,new n.instance(t,"messagesCommon");t.getIsTypingTimeDefault=function(){return 1500},t.addTypingMessage=function(e,o){let a=t.getIsTypingTimeDefault(),i=e.idElementToAppendFrom;new n.isTypingMessage({idElementToAppendFrom:i}).addChatTypingFor(a,o)},t.appendComponentWithAnimation=function(t,n,e){e.classList.add("js__prepareChatAppearingAnimation"),t.appendComponentNode(n,e),e.offsetWidth,e.classList.add("js__animateChatAppearingAnimation")},t.getValidatedText=function(t){let n=document.createElement("div");return n.innerHTML=t,[...n.querySelectorAll("*")].forEach(t=>{cleanNode(t),replaceVariables(t),addTargetBlankToAnchors(t)}),n.innerHTML};let cleanNode=function(t){let n={isAnchor:"A"===t.nodeName,isImage:"IMG"===t.nodeName,isBold:"B"===t.nodeName,isUnderline:"U"===t.nodeName,isItalic:"I"===t.nodeName,isNewLine:"BR"===t.nodeName,isVar:"VAR"===t.nodeName};Object.values(n).some(t=>t)?t.getAttributeNames().forEach(n=>removeAttribute(t,n)):t.remove()},removeAttribute=function(t,n){o.some(t=>t.toUpperCase()===n.toUpperCase())||t.removeAttribute(n)},o=["href","src"],replaceVariables=function(t){"VAR"!==t.nodeName?o.forEach(n=>{let e=t.getAttribute(n);if(null===e)return;let o=document.createElement("DIV");o.innerHTML=e,o.querySelectorAll("var").forEach(replaceVarTagContent);let a=o.childNodes[0].nodeValue;t.setAttribute(n,a)}):replaceVarTagContent(t)},replaceVarTagContent=function(t){let n=e.get("conversationQueue").getAllVariables()[t.innerHTML];if(void 0===n)throw`The variable "${t.innerHTML}" was not defined.`;t.outerHTML=n},addTargetBlankToAnchors=function(t){"A"===t.nodeName&&t.setAttribute("target","_blank")}})),window.taglio_chat_app.addToLibs((function agentMessage_style(){return'\n<style id="agentMessage_style">\n\n/* Animation for chat appearing */\n.taglioChapApp_agentMessage .js__prepareChatAppearingAnimation{\n    transition: transform 0.25s linear;\n    transition: opacity 0.25s linear;\n    transform: scale(0.5);\n    opacity: 0.2;\n}\n\n.taglioChapApp_agentMessage .js__animateChatAppearingAnimation{\n    transform: scale(1);\n    opacity: 1;\n}\n\n.taglioChapApp_agentMessage .chat_agent{\n    background-color: var(--primary_color);\n    color: var(--white_color);\n}\n\n.taglioChapApp_agentMessage img{\n    width: 100%;\n    height: auto;\n}\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function agentMessage_template(){return'\n    \n<div class="taglioChapApp_agentMessage agent">\n  <p data-el="chat_text" class="chat_item chat_agent">{message}</p>\n</div>\n\n    '})),window.taglio_chat_app.addToLibs((function agentMessage(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=new n.instance(this,"visitorMessage-"+o.newUniqueId()),i=t.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";let r=t.message;if("object"!=typeof r)throw"invalid message. Must be an object";this.run=function(t){if("function"!=typeof t)throw"onDone must a function";if(""===r.text){return e.get("conversationQueue").endConversationOnDemand(),void runOnDone(t)}e.get("messagesCommon").addTypingMessage({idElementToAppendFrom:i},()=>{createDom(),runOnDone(t)})},this.addMessage=function(){createDom()};let runOnDone=function(t){let n=r.nextId;t(r.conversationId,n)},createDom=function(){a.addStyle(n.agentMessage_style());let t=e.get("messagesCommon"),s=r.text,p=t.getValidatedText(s),l=n.agentMessage_template(),d=o.createDomNode(l,[{message:p}]);t.appendComponentWithAnimation(a,i,d)}})),window.taglio_chat_app.addToLibs((function callbackMessage(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=(new n.instance(this,"callbackMessage-"+o.newUniqueId()),t.idElementToAppendFrom);if("string"!=typeof a||""===a)throw"invalid idElementToAppendFrom. Must be a non empty string";let i=t.message;if("object"!=typeof i)throw"invalid message. Must be an object";this.run=function(t){if("function"!=typeof t)throw"onDone must a function";try{runMessageCallback(n=>{handleCallbackResult(n,t)})}catch(n){console.error(n),handleCallbackResult({type:"text",text:""},t)}};let runMessageCallback=function(t){let e=new n.isTypingMessage({idElementToAppendFrom:a}),o=performance.now();e.start(),i.callback(n=>{let a=performance.now(),i=calculateStopRemainingTime(o,a);e.stopAfterTime(i,()=>{t(n,t)})})},calculateStopRemainingTime=function(t,n){if("number"!=typeof t)throw"startTime must be a number";if("number"!=typeof n)throw"endTime must be a number";if(t>n)throw`Start time "${t}" must lower than endTime "${n}" `;let o=e.get("messagesCommon").getIsTypingTimeDefault()-(n-t);return o<=0&&(o=0),o},handleCallbackResult=function(t,n){if(null===t){return void n(i.conversationId,i.nextId)}e.get("conversationManager").prepareConversationOrThrow(t);let o=t[0];n(o.conversationId,o.id)}})),window.taglio_chat_app.addToLibs((function choiceMessage_style(){return'\n<style id="choiceMessage_style">\n\n.taglioChapApp_choiceMessage{\n    white-space: nowrap;\n}\n\n.taglioChapApp_choiceMessage .choiceText{\n    \n    line-height: 16px;\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 10px;\n    margin-right: 5px;\n}\n\n.taglioChapApp_choiceMessage .optionsHolder{\n    border-radius: 16px;\n    line-height: 16px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n}\n\n.taglioChapApp_choiceMessage .option{\n    text-align:center;\n\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n    \n    padding: 8px 12px;\n    margin:0;\n    cursor: pointer;\n\n    background-color:white;\n    color:var(--primary_color);\n    border: 1px solid var(--primary_color);\n    border-top:0;\n}\n\n.taglioChapApp_choiceMessage .question{\n    text-align:center;\n\n    overflow-wrap: break-word;\n    white-space: pre-wrap;\n    \n    padding: 8px 12px;\n    margin:0;\n\n    border-top:0;\n\n    border: 1px solid var(--primary_color);;\n    background-color:var(--primary_color);\n    color:white;\n\n    border-top-right-radius: 16px;\n    border-top-left-radius: 16px;\n}\n\n.taglioChapApp_choiceMessage .js__noEvents{\n    pointer-events: none;\n}\n\n.taglioChapApp_choiceMessage img{\n    width: 13%;\n    height: auto;\n}\n\n.taglioChapApp_choiceMessage .option:hover,\n.taglioChapApp_choiceMessage .option:focus{\n    opacity: 0.7;\n\n    background-color:var(--primary_color);\n    color:white;\n}\n\n\n.taglioChapApp_choiceMessage .optionsHolder  .option:last-child{\n    border-bottom-right-radius: 16px;\n    border-bottom-left-radius: 16px;\n}\n\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function choiceMessage_template(){return'\n    \n<div class="taglioChapApp_choiceMessage agent">\n  <div class="optionsHolder" data-el="options_holder">\n    <p class="question" data-el="option" data-conversation-id="{conversationId}">{message}</p>\n  </div>\n    \n    <template data-el="options_template">\n      <p class="option" data-el="option" data-conversation-id="{conversationId}" data-is-null="{isNull}">{text}</p>\n    </template>\n</div>\n\n    '})),window.taglio_chat_app.addToLibs((function choiceMessage(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=new n.instance(this,"choiceMessage-"+o.newUniqueId()),i=t.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";let r=t.message;if("object"!=typeof r)throw"invalid message. Must be an object";this.run=function(t){if("function"!=typeof t)throw"onDone must a function";e.get("messagesCommon").addTypingMessage({idElementToAppendFrom:i},()=>{createDom(),listenTo_clickOnOption(t)})};let listenTo_clickOnOption=function(t){a.findAll("option").forEach(n=>{n.onclick=function(n){let e=n.target.closest("[data-conversation-id]");null===e&&(e=n.target);let o=e.getAttribute("data-conversation-id"),a="true"===e.getAttribute("data-is-null"),i=e.innerHTML;clickOnOption({conversationId:o,text:i,isNullConversation:a,goToNextMessageCallback:t})}})},clickOnOption=function(t){const{conversationId:i,text:s,isNullConversation:p,goToNextMessageCallback:l}=t;a.findAll("option").forEach(t=>{o.mustAddClass(t,"js__noEvents",!0),t.onclick=null});let d={idElementToAppendFrom:e.get("chatLayout").getChatContentId(),text:s};new n.visitorMessage(d).runSync();let c=getOptionConversationInfoOrNull(i),h=r.nextId;p||(h=c.nextId),l(i,h)},createDom=function(){a.addStyle(n.choiceMessage_style());let t=e.get("messagesCommon"),s=n.choiceMessage_template(),p=o.createDomNode(s,[{message:r.text}]),l=p.querySelector('[data-el="options_template"]').innerHTML,d=r.options.map(n=>{let e=t.getValidatedText(n.text),a=buildOptionInfoForDom(n.conversation),i={text:e,conversationId:a.conversationId,isNull:a.isNull};return o.createDomNode(l,[i])}),c=p.querySelector('[data-el="options_holder"]');d.forEach(t=>c.append(t)),t.appendComponentWithAnimation(a,i,p)},buildOptionInfoForDom=function(t){if(null===t){return{conversationId:r.conversationId,isNull:!0}}return{conversationId:getConversationIdFromOption(t),isNull:!1}},getConversationIdFromOption=function(t){return t[0].conversationId},getOptionConversationInfoOrNull=function(t){let n=r.options.find(n=>getConversationIdFromOption(n.conversation)===t).conversation;return void 0===n?null:{conversation:n,nextId:n[0].id}}})),window.taglio_chat_app.addToLibs((function inputMessage(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=(new n.instance(this,"inputMessage-"+o.newUniqueId()),t.idElementToAppendFrom);if("string"!=typeof a||""===a)throw"invalid idElementToAppendFrom. Must be a non empty string";let i=t.message;if("object"!=typeof i)throw"invalid message. Must be an object";let r=null;this.run=function(t){if("function"!=typeof t)throw"onDone must a function";if(void 0===i.text)return void handleInput(t);let o={idElementToAppendFrom:e.get("chatLayout").getChatContentId(),message:{text:i.text}};new n.agentMessage(o).run(()=>handleInput(t))};let handleInput=function(t){let n=e.get("chatLayout");n.mustDisableTextArea(!1),n.listenToInputMessage(o=>{n.removeListenerToInputMessage(),e.get("conversationQueue").addVariable(i.variable,o),n.mustDisableTextArea(!0),r=o,t(i.conversationId,i.nextId)})}})),window.taglio_chat_app.addToLibs((function isTypingMessage_style(){return'\n<style id="isTypingMessage_style">\n\n.taglioChapApp_isTypingMessage {\n}\n\n/* Is typing animation */\n.taglioChapApp_isTypingMessage .chat-bubble {\n\n    width: fit-content;\n    justify-content: center;\n    border-radius: 16px;\n    line-height: 16px;\n    padding: 8px 12px;\n    overflow-wrap: break-word;\n    max-width: 200px;\n    margin:0;\n    margin-bottom: 5px;\n\n    background-color: var(--agent_chat_color);\n    color: var(--default_text_color);\n}\n  \n.taglioChapApp_isTypingMessage .typing {\n    align-items: center;\n    display: flex;\n}\n.taglioChapApp_isTypingMessage .typing .dot {\n    animation: mercuryTypingAnimation 1.5s infinite ease-in-out;\n    background-color: var(--default_text_color); \n    border-radius: 50%;\n    height: 5px;\n    margin-right: 4px;\n    vertical-align: middle;\n    width: 5px;\n    display: inline-block;\n}\n\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(1) {\n    animation-delay: 200ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(2) {\n    animation-delay: 300ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:nth-child(3) {\n    animation-delay: 400ms;\n}\n.taglioChapApp_isTypingMessage .typing .dot:last-child {\n    margin-right: 0;\n}\n\n@keyframes mercuryTypingAnimation {\n    0% {\n        transform: translateY(0px);\n        background-color:var(--default_text_color); \n    }\n    28% {\n        transform: translateY(-7px);\n        background-color:var(--default_text_color); \n    }\n    44% {\n        transform: translateY(0px);\n        background-color: var(--default_text_color); \n    }\n}\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function isTypingMessage_template(){return'\n    \n<div class="taglioChapApp_isTypingMessage agent">\n  <div class="chat-bubble">\n  <div class="typing">&nbsp;\n    <div class="dot"></div>\n    <div class="dot"></div>\n    <div class="dot"></div>\n    &nbsp;</div>\n  </div>\n</div>\n\n    '})),window.taglio_chat_app.addToLibs((function isTypingMessage(t){let n=this,e=window.taglio_chat_app.libs,o=(window.taglio_chat_app.instanceManager,window.taglio_chat_app.staticMethods),a=new e.instance(n,"isTypingMessage-"+o.newUniqueId()),i=t.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";n.addChatTypingFor=function(t,e){createDom(),n.stopAfterTime(t,e)},n.start=function(){createDom()},n.stop=function(){a.destroy()},n.stopAfterTime=function(t,n){setTimeout(()=>{a.destroy(),n()},t)};let r=!1,createDom=function(){if(r)return;r=!0,a.addStyle(e.isTypingMessage_style());let t=e.isTypingMessage_template();a.createComponentDom(i,t)}})),window.taglio_chat_app.addToLibs((function visitorMessage_style(){return'\n<style id="visitorMessage_style">\n\n.taglioChapApp_visitorMessage .chat_visitor{\n    background-color: var(--agent_chat_color);\n    color: var(--default_text_color);\n}\n\n.taglioChapApp_visitorMessage .chat_visitor img{\n    width:100%;\n    height: auto;\n}\n\n.taglioChapApp_visitorMessage{\n    display: flex;\n    justify-content: flex-end;\n}\n\n</style>\n'})),window.taglio_chat_app.addToLibs((function visitorMessage_template(){return'\n    \n<div class="taglioChapApp_visitorMessage visitor">\n  <p data-el="chat_text" class="chat_item chat_visitor">{message}</p>\n</div>\n\n    '})),window.taglio_chat_app.addToLibs((function visitorMessage(t){let n=window.taglio_chat_app.libs,e=window.taglio_chat_app.instanceManager,o=window.taglio_chat_app.staticMethods,a=new n.instance(this,"visitorMessage-"+o.newUniqueId()),i=t.idElementToAppendFrom;if("string"!=typeof i||""===i)throw"invalid idElementToAppendFrom. Must be a non empty string";let r=t.text;if("string"!=typeof r||""===r)throw"text must be a non empty string";this.runSync=function(){createDom()};let createDom=function(){a.addStyle(n.visitorMessage_style());let t=e.get("messagesCommon"),s=n.visitorMessage_template(),p=o.createDomNode(s,[{message:r}]);t.appendComponentWithAnimation(a,i,p)}}));